/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./app/src/js/app.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./app/src/js/FamilyTree.js":
/*!**********************************!*\
  !*** ./app/src/js/FamilyTree.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FamilyTree = exports.FamilyTree = function () {\n  function FamilyTree(nodes) {\n    _classCallCheck(this, FamilyTree);\n\n    this.nodes = nodes;\n\n    this.maxDepth = 0;\n    this.minFreeIndivId = _.max(_.map(_.filter(this.nodes, function (n) {\n      return n.tag == \"INDI\";\n    }), function (nd) {\n      return parseInt(nd.id.replace(/@|F|I/g, \"\"));\n    })) + 1;\n    this.minFreeFamId = _.max(_.map(_.filter(this.nodes, function (n) {\n      return n.tag == \"FAM\";\n    }), function (nd) {\n      return parseInt(nd.id.replace(/@|F|I/g, \"\"));\n    })) + 1;\n    if (isNaN(this.minFreeIndivId)) {\n      this.minFreeIndivId = 1;\n    }\n    if (isNaN(this.minFreeFamId)) {\n      this.minFreeFamId = 1;\n    }\n\n    // add names to family nodes, and spouse() method\n    this.nodes = _.forEach(this.nodes, function (n) {\n      if (n.tag === \"FAM\") {\n        n.name += \" \" + (n.husb ? n.husb.name : \"\") + \",\" + (n.wife ? n.wife.name : \"\");\n      }\n      FamilyTree.addSpouseMethod(n);\n    });\n\n    //compute nodes positions\n    //this.computeLayout()\n  }\n\n  /**\n   * Serialize the family tree in a JSON ready JS object\n   * \n   * By default this only serializes the basic properties of nodes according to family-tree:\n   * - id, name, sex, tag, fams, famc, chil, wife, husb\n   * \n   * Moreover, FamilyTree nodes are linked (with properties fams, famc, chil, wife, husb) together\n   * by references, this creates cycles.\n   * Hence, this method also replace inter-nodes references by node ids.\n   * \n   * @param {Array[string]} properties (optional) additional properties to be saved\n   * @returns {Object} a JSON ready JS object with structure\n   * {\n   *   class : \"FamilyTree\", // Class of the object\n   *   nodes : nodes, // nodes in an array with ids as links\n   *   properties : properties // the list of properties the nodes have\n   * }\n   */\n\n\n  _createClass(FamilyTree, [{\n    key: \"serialize\",\n    value: function serialize() {\n      var properties = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      properties = [\"id\", \"name\", \"sex\", \"tag\", \"fams\", \"famc\", \"chil\", \"wife\", \"husb\"].concat(properties).filter(function (v, i, s) {\n        return s.indexOf(v) === i;\n      });\n      var nodes = this.nodesArray();\n      nodes = nodes.map(function (n) {\n        var tr = {};\n        properties.forEach(function (p) {\n          return tr[p] = n[p];\n        });\n        return tr;\n      });\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = nodes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var n = _step.value;\n\n          n.fams = n.fams ? n.fams.map(function (f) {\n            return f.id;\n          }) : null;\n          n.chil = n.chil ? n.chil.map(function (c) {\n            return c.id;\n          }) : null;\n          n.famc = n.famc ? n.famc.id : null;\n          n.wife = n.wife ? n.wife.id : null;\n          n.husb = n.husb ? n.husb.id : null;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return {\n        class: \"FamilyTree\",\n        nodes: nodes,\n        properties: properties\n      };\n    }\n    /** Takes care of re-establishing the object references in nodes links, the inverse of serialize()\n     * \n     * @param {Array[nodes]} nodesArray an array of nodes, where the fams, famc, chil, wife, husb properties are node ids\n     * @returns A dictionary with node ids as keys and nodes as values and fams, famc, chil, wife properties are direct references\n     */\n\n  }, {\n    key: \"nodesArray\",\n    value: function nodesArray() {\n      return _.map(this.nodes, function (n) {\n        return n;\n      });\n    }\n\n    /**\n     * Checks whether the Family Tree contains the given node (a node with id property or directly a str id)\n     * @param {node or str} node \n     */\n\n  }, {\n    key: \"contains\",\n    value: function contains(node) {\n      return Boolean(node.id ? this.nodes[node.id] : this.nodes[node]);\n    }\n\n    /**\n     * Get links between all nodes: parents, children and family nodes\n     */\n\n  }, {\n    key: \"getLinks\",\n    value: function getLinks() {\n      var links = [];\n      _.forEach(this.nodes, function (node) {\n        if (node.famc) {\n          links.push([node.famc, node]);\n        }\n        if (node.wife) {\n          links.push([node.wife, node]);\n        }\n        if (node.husb) {\n          links.push([node.husb, node]);\n        }\n      });\n      return links;\n    }\n  }, {\n    key: \"getLinksAsIds\",\n    value: function getLinksAsIds() {\n      return this.getLinks().map(function (l) {\n        return l.map(function (n) {\n          return n.id;\n        });\n      });\n    }\n\n    /**\n     * Get links between parents and children, removing family nodes\n     */\n\n  }, {\n    key: \"getParentChildLinks\",\n    value: function getParentChildLinks() {\n      var links = [];\n      var addEdge = function addEdge(a, b) {\n        links.push([a, b]);\n      };\n      this.nodesArray().filter(function (n) {\n        return n.tag == \"FAM\";\n      }).forEach(function (familyNode) {\n        if (familyNode.chil) {\n          familyNode.chil.forEach(function (child) {\n            if (familyNode.wife) addEdge(familyNode.wife, child);\n            if (familyNode.husb) addEdge(familyNode.husb, child);\n          });\n        }\n      });\n      return links;\n    }\n  }, {\n    key: \"getParentChildLinksAsIds\",\n    value: function getParentChildLinksAsIds() {\n      return this.getParentChildLinks().map(function (link) {\n        return [link[0].id, link[1].id];\n      });\n    }\n\n    /*\n    Computes depth of all the nodes in the family tree\n    Also computes max- and min-deph reachable from node relative to centerNode\n    adds following properties to each node:\n    - depth\n    - minDepth\n    - maxDepth\n    */\n\n  }, {\n    key: \"_computeDepths\",\n    value: function _computeDepths(startNode) {\n\n      _.forEach(this.nodes, function (n) {\n        return delete n.depth;\n      });\n      this._computeDepthsRecursive(startNode, 0);\n\n      //ensure non-negative depths & compute family tree global maximum depth\n      var depthExtent = d3.extent(_.map(this.nodes, function (n) {\n        return n.depth;\n      }));\n      var minDepth = depthExtent[0];\n      this.maxDepth = depthExtent[1] - minDepth;\n      //this.nodes = _.mapValues(this.nodes, n=> {n.depth-=minDepth;return n})\n      _.forEach(this.nodes, function (n) {\n        n.depth -= minDepth;\n        n.minDepth -= minDepth;\n        n.maxDepth -= minDepth;\n      });\n    }\n  }, {\n    key: \"_computeDepthsRecursive\",\n    value: function _computeDepthsRecursive(node, depth) {\n      var _this = this;\n\n      if (!node) {\n        return;\n      }\n      //console.log(\"_computeDepthsRecursive! \"+node.id+\" at depth \"+depth)\n      if (node.depth != undefined) {\n        if (node.depth != depth) {\n          throw \"DepthError: \" + node.id + \" resolves to 2 different depths: \" + node.depth + \" and \" + depth;\n        }\n        return;\n      }\n      var maxmindepths = [[depth, depth]];\n\n      node.depth = depth;\n      maxmindepths.push(this._computeDepthsRecursive(node.husb, depth));\n      maxmindepths.push(this._computeDepthsRecursive(node.wife, depth));\n      maxmindepths.push(this._computeDepthsRecursive(node.famc, depth - 1));\n      if (node.fams) {\n        node.fams.forEach(function (fam) {\n          return maxmindepths.push(_this._computeDepthsRecursive(fam, depth));\n        });\n      }\n      if (node.chil) {\n        node.chil.map(function (chil) {\n          return maxmindepths.push(_this._computeDepthsRecursive(chil, depth + 1));\n        });\n      }\n      maxmindepths = maxmindepths.filter(function (mmd) {\n        return mmd != undefined;\n      });\n      node.minDepth = d3.min(maxmindepths, function (d) {\n        return d[0];\n      });\n      node.maxDepth = d3.max(maxmindepths, function (d) {\n        return d[1];\n      });\n      return [node.minDepth, node.maxDepth];\n    }\n  }, {\n    key: \"getNode\",\n    value: function getNode(nodeOrNodeId) {\n      return _.isString(nodeOrNodeId) ? this.nodes[nodeOrNodeId] : nodeOrNodeId;\n    }\n\n    /* add a family to tree, wife, husb chil must be nodes or node ids*/\n\n  }, {\n    key: \"addFamily\",\n    value: function addFamily(wife, husb, child) {\n      //console.log(\"addFamily\")\n      var node = {\n        id: FamilyTree.gedcomId(this.minFreeFamId++, \"F\"),\n        tag: \"FAM\",\n        wife: this.getNode(wife),\n        husb: this.getNode(husb),\n        chil: [child].map(this.getNode).filter(function (x) {\n          return x != undefined;\n        }),\n        spouse: function spouse() {\n          return undefined;\n        }\n      };\n      this.nodes[node.id] = node;\n      return node;\n    }\n\n    /* add an individual to tree, famcId,famsId must be nodes or node ids*/\n\n  }, {\n    key: \"addIndividual\",\n    value: function addIndividual(name, famc, fams, sex) {\n      //console.log(\"addIndividual\")\n      var node = {\n        id: FamilyTree.gedcomId(this.minFreeIndivId++),\n        tag: \"INDI\",\n        name: name,\n        famc: this.getNode(famc),\n        fams: [fams].map(this.getNode).filter(function (x) {\n          return x != undefined;\n        }),\n        sex: sex\n      };\n      FamilyTree.addSpouseMethod(node);\n      this.nodes[node.id] = node;\n\n      return node;\n    }\n\n    /* add child to given parent in tree\n    Also adds spouse if needed\n    */\n\n  }, {\n    key: \"addChild\",\n    value: function addChild(name, sex, parent) {\n      var addSpouseToo = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      var spouseDefaultName = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"spouse\";\n\n      //console.log(\"addChild\")\n      parent = this.getNode(parent);\n      var famc = parent.fams[0];\n      if (!famc) {\n        famc = parent.sex == \"F\" ? this.addFamily(parent) : this.addFamily(undefined, parent);\n        parent.fams.push(famc);\n      }\n      if (addSpouseToo && !parent.spouse()) {\n        this.addSpouse(spouseDefaultName, parent);\n      }\n      var child = this.addIndividual(name, famc, undefined, sex);\n      famc.chil.push(child);\n      return child;\n    }\n\n    /* add a parent to given child in tree, childId must be a node id or undefined*/\n\n  }, {\n    key: \"addParent\",\n    value: function addParent(name, sex, child) {\n      child = this.getNode(child);\n      //console.log(\"addParent\")\n      var fams = child.famc;\n      if (!fams) {\n        fams = this.addFamily(undefined, undefined, child);\n        child.famc = fams;\n      }\n      var parent = sex === \"F\" ? fams.wife : fams.husb;\n      if (parent) {\n        return parent;\n      }\n      parent = this.addIndividual(name, undefined, fams, sex);\n      sex == \"F\" ? fams.wife = parent : fams.husb = parent;\n      return parent;\n    }\n\n    /* add a spouse to given spouse in tree, spouseId must be a node id or undefined*/\n\n  }, {\n    key: \"addSpouse\",\n    value: function addSpouse(name, spouse) {\n      var spouse1 = this.getNode(spouse);\n      //console.log(\"addParent\")\n      var fams = spouse1.fams[0];\n      if (!fams) {\n        fams = spouse1.sex == \"F\" ? this.addFamily(spouse1) : this.addFamily(undefined, spouse1);\n        spouse1.fams.push(fams);\n      }\n      var spouse2 = spouse1.sex === \"F\" ? fams.husb : fams.wife;\n      if (spouse2) {\n        return spouse2;\n      }\n      spouse2 = this.addIndividual(name, undefined, fams, spouse1.sex === \"F\" ? \"M\" : \"F\");\n      spouse2.sex == \"F\" ? fams.wife = spouse2 : fams.husb = spouse2;\n      return spouse2;\n    }\n\n    /*\n    properly removes a given node from the family tree, including links and references to it.\n    Also automatically deletes family nodes that are no longer needed.\n    Can also delete all the nodes that are no longer connected to the main tree.\n     arguments:\n    - node: node or node id to be deleted\n    - deleteNodesNotConnectedTo: node or node id, the function deletes all the nodes that are no longer connected to it once the first node has been removed.\n    */\n\n  }, {\n    key: \"deleteNode\",\n    value: function deleteNode(node) {\n      var deleteNodesNotConnectedTo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      node = this.getNode(node);\n      //console.log(\"deleteNode, node.id=\"+node.id+\", \")\n      if (!node) {\n        return new Set();\n      }\n\n      // remove references to this node in other connected nodes\n      if (node.famc) {\n        node.famc.chil = node.famc.chil.filter(function (c) {\n          return c.id != node.id;\n        });\n      }\n      if (node.husb) {\n        node.husb.fams = node.husb.fams.filter(function (c) {\n          return c.id != node.id;\n        });\n      }\n      if (node.wife) {\n        node.wife.fams = node.wife.fams.filter(function (c) {\n          return c.id != node.id;\n        });\n      }\n      if (node.chil) {\n        node.chil.forEach(function (c) {\n          return delete c.famc;\n        });\n      }\n      if (node.fams) {\n        node.fams.forEach(function (c) {\n          if (c.wife && c.wife.id == node.id) {\n            delete c.wife;\n          }\n          if (c.husb && c.husb.id == node.id) {\n            delete c.husb;\n          }\n        });\n      }\n      var deletedNodeId = node.id;\n      delete this.nodes[node.id];\n\n      // remove family nodes that are no longer needed\n      var needlessFamilies = _.filter(this.nodes, function (n) {\n        return n.tag === \"FAM\" && (\n        //( (!n.wife) && (!n.husb)  && (n.chil?n.chil.length<=1:true)) || // no wife, no husb and 1 child -> family no longer needed\n        !n.wife && !n.husb || // no wife, no husb -> family no longer needed\n        (!n.wife || !n.husb) && (n.chil ? n.chil.length == 0 : true) // only 1 spouse and no child -> family no longer needed\n        );\n      });\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = needlessFamilies[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var fam = _step2.value;\n          this.deleteNode(fam);\n        }\n\n        // also eliminate elements that are no longer connected to the deleteNodesNotConnectedTo node and families without spouses\n        //console.log(\"deleteNode, nodes pre-_computeDepths():\")\n        //console.log(this.nodes)\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var noLongerConnectedNodesIds = [];\n      if (deleteNodesNotConnectedTo) {\n        var startNode = this.getNode(deleteNodesNotConnectedTo);\n        this._computeDepths(startNode);\n        noLongerConnectedNodesIds = _.filter(this.nodes, function (n) {\n          return n.depth == undefined || isNaN(n.depth);\n        }).map(function (n) {\n          return n.id;\n        });\n      }\n      var deletedNodeIds = new Set([].concat(_toConsumableArray(noLongerConnectedNodesIds), _toConsumableArray(needlessFamilies.map(function (n) {\n        return n.id;\n      })))).add(deletedNodeId);\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = deletedNodeIds[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var nid = _step3.value;\n          delete this.nodes[nid];\n        }\n\n        // ensure clean chil and fams arrays\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      this.cleanChilArrays();\n      this.cleanFamsArrays();\n\n      return deletedNodeIds;\n    }\n\n    // ensure there aren't any \"undefined\" element in nodes' chil or fams arrays\n\n  }, {\n    key: \"cleanChilArrays\",\n    value: function cleanChilArrays() {\n      _.forEach(this.nodes, function (node) {\n        return node.chil ? node.chil = node.chil.filter(Boolean) : node.chil;\n      });\n    }\n  }, {\n    key: \"cleanFamsArrays\",\n    value: function cleanFamsArrays() {\n      _.forEach(this.nodes, function (node) {\n        return node.fams ? node.fams = node.fams.filter(Boolean) : node.fams;\n      });\n    }\n  }], [{\n    key: \"unserializeParseNodes\",\n    value: function unserializeParseNodes(serializedFtree) {\n      var nodesDict = {};\n      serializedFtree.nodes.forEach(function (n) {\n        return nodesDict[n.id] = n;\n      });\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = serializedFtree.nodes[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var n = _step4.value;\n\n          n.fams = n.fams ? n.fams.map(function (f) {\n            return nodesDict[f];\n          }) : [];\n          n.chil = n.chil ? n.chil.map(function (c) {\n            return nodesDict[c];\n          }) : [];\n          n.famc = n.famc ? nodesDict[n.famc] : null;\n          n.wife = n.wife ? nodesDict[n.wife] : null;\n          n.husb = n.husb ? nodesDict[n.husb] : null;\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return nodesDict;\n    }\n    /** Unserializes a FamilyTree serialized with JSON.stringify(FamilyTree.serialize())\n     * \n     * @param {string} serializedFtree\n     * @returns {FamilyTree}\n     */\n\n  }, {\n    key: \"unserialize\",\n    value: function unserialize(serializedFtree) {\n      serializedFtree = JSON.parse(serializedFtree);\n      return new FamilyTree(FamilyTree.unserializeParseNodes(serializedFtree));\n    }\n  }, {\n    key: \"gedcomId\",\n    value: function gedcomId(idnb) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"I\";\n\n      return \"@\" + type + idnb + \"@\";\n    }\n  }, {\n    key: \"addSpouseMethod\",\n    value: function addSpouseMethod(n) {\n      n.spouse = function () {\n        var famsIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n        // only if desired fams exists...\n        if (this.fams && this.fams.length > famsIndex) {\n          var fams = this.fams[famsIndex];\n          // only if both spouses... present\n          if (fams.wife && fams.husb) {\n            // ...can we find the spouse\n            return this.id == fams.wife.id ? fams.husb : fams.wife;\n          }\n        }\n        return undefined;\n      };\n    }\n  }]);\n\n  return FamilyTree;\n}();\n\n//# sourceURL=webpack:///./app/src/js/FamilyTree.js?");

/***/ }),

/***/ "./app/src/js/FamilyTreeArtist.js":
/*!****************************************!*\
  !*** ./app/src/js/FamilyTreeArtist.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FamilyTreeArtist = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _NodeButtonsGroup = __webpack_require__(/*! ./NodeButtonsGroup.js */ \"./app/src/js/NodeButtonsGroup.js\");\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FamilyTreeArtist = exports.FamilyTreeArtist = function () {\n  function FamilyTreeArtist(kgp, i18n) {\n    var transitionDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 800;\n\n    _classCallCheck(this, FamilyTreeArtist);\n\n    this.kgp = kgp;\n    this.ftree = this.kgp.ftree;\n    this.i18n = i18n;\n    this.heightFtree = 0;\n    this.init(transitionDuration);\n  }\n\n  _createClass(FamilyTreeArtist, [{\n    key: \"init\",\n    value: function init() {\n      var transitionDuration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 800;\n\n      this.ftree = this.kgp.ftree;\n      var self = this;\n      this.svgg = this.kgp.svg.append(\"g\").attr(\"id\", \"familytree-g\");\n\n      this.update(false, transitionDuration);\n\n      // distinguish you node\n      //this.kgp.target = this.ftree.nodes[this.kgp.youNodeId]\n      var meNodeGroup = d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(this.kgp.youNodeId)).classed(\"you\", true).each(function (d) {\n        d.buttons = _NodeButtonsGroup.youNodeButtons; //youTargetNodeButtons\n        d.i18nName = \"you\";\n      });\n      meNodeGroup.select(\".node-name\").each(function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(d) {\n          var nodeNameYou;\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return self.i18n.t(\"node-name-you\");\n\n                case 2:\n                  nodeNameYou = _context.sent;\n\n                  if (Boolean(d.name) & d.name != nodeNameYou) {\n                    this.innerHTML = d.name;\n                  } else {\n                    this.setAttribute(self.i18n.keyAttr, \"node-name-you\");\n                  }\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        return function (_x3) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n\n      this.initNodeButtons();\n\n      // hide on mouseleave\n      this.nodeButtons.g.on(\"mouseleave.hide\", function (d) {\n        return self.nodeButtons.hide();\n      });\n\n      // highlight links on hover\n      this.nodeButtons.g.on(\"mouseover.toggleHighlightNodeLinks\", self.generateToggleHighlightNodeLinks(true));\n      this.nodeButtons.g.on(\"mouseleave.toggleHighlightNodeLinks\", self.generateToggleHighlightNodeLinks(false));\n      this.nodeButtons.g.on(\"click.toggleHighlightNodeLinks\", self.generateToggleHighlightNodeLinks(false));\n    }\n  }, {\n    key: \"update\",\n    value: function update(updateSource) {\n      var transitionsDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 800;\n\n      var self = this;\n      updateSource = updateSource ? { x: updateSource.x, y: updateSource.y } : false;\n      this.ftree.computeLayout(false);\n      this.ftree.center(true, false);\n\n      // rescale tree if gets out of svg\n      var ftreeLeftMargin = 70; // 20 pix for target button, 50 for first node circle\n      var ftreeRightMargin = 170; // 120 for add-relative menu, 50 for last node circle\n      var widthFtree = ftreeLeftMargin + this.ftree.width() + ftreeRightMargin;\n\n      var miny = this.ftree.minY();\n      this.heightFtree = this.ftree.maxY() - miny + 150;\n      // if we can still resize the svg -> let's do it!\n\n      var widthScaleFactor = d3.min([1, this.kgp.svgWidth / widthFtree]);\n      this.kgp.updateSvgHeight(this.heightFtree * widthScaleFactor, transitionsDuration);\n\n      var scaleFactor = d3.min([1, widthScaleFactor, this.kgp.svgHeight / this.heightFtree]);\n\n      var translateX = widthFtree < this.kgp.svgWidth - ftreeRightMargin / 2 ? this.kgp.svgWidth / 2 : scaleFactor * (this.ftree.width() / 2 + ftreeLeftMargin);\n\n      this.svgg.transition().duration(transitionsDuration).attr(\"transform\", \"translate(\" + translateX + \",\" + scaleFactor * (80 - miny) + \") scale(\" + scaleFactor + \")\");\n      // for tutorial videos, use these settings:\n      //.attr(\"transform\",\"translate(\"+550+\",\"+(scaleFactor*(75-miny))+\") scale(\"+scaleFactor+\")\")\n\n      // updateSource:\n      updateSource = updateSource ? updateSource : { x: translateX + (widthFtree - ftreeRightMargin) / 2, y: 50 };\n      this.updateLinks(updateSource, transitionsDuration);\n      this.updateNodes(updateSource, transitionsDuration);\n    }\n  }, {\n    key: \"updateLinks\",\n    value: function updateLinks(source, transitionsDuration) {\n      var _this = this;\n\n      var self = this;\n\n      // adds the links between the nodes\n      var link = this.svgg.selectAll(\".link\");\n\n      // remove links whose source or target is no longer in this.ftree\n      var keepLink = function keepLink(d) {\n        return Boolean(_this.ftree.nodes[d[0].id]) && Boolean(_this.ftree.nodes[d[1].id]);\n      };\n      var linkExit = link.filter(function (d) {\n        return !keepLink(d);\n      });\n      linkExit.transition().duration(transitionsDuration).attr(\"d\", function (d) {\n        return FamilyTreeArtist.renderLink(d[1], d[1]);\n      }).remove();\n\n      link = link.filter(keepLink).data(this.ftree.getLinks(),\n      // add key function: make sure each ftree-link is assigned to the right svg-link-path\n      function (d) {\n        return d ? FamilyTreeArtist.linkNodeId(d[0].id, d[1].id) : this.id;\n      });\n      var linkEnter = link.enter().insert(\"path\", \".nodeg\").attr(\"id\", function (d) {\n        return FamilyTreeArtist.linkNodeId(d[0].id, d[1].id);\n      }).attr(\"class\", function (d) {\n        return \"link \" + FamilyTreeArtist.linkNodeClass(d[0].id) + \" \" + FamilyTreeArtist.linkNodeClass(d[1].id);\n      }).attr(\"d\", FamilyTreeArtist.renderLink(source, source)).attr(\"fill\", \"none\").attr(\"stroke\", \"lightgrey\");\n\n      var linkUpdate = linkEnter.merge(link);\n      linkUpdate.transition().duration(transitionsDuration).attr(\"d\", function (d) {\n        return FamilyTreeArtist.renderLink(d[0], d[1]);\n      });\n    }\n  }, {\n    key: \"updateNodes\",\n    value: function updateNodes(source, transitionsDuration) {\n      var _this2 = this;\n\n      var self = this;\n\n      // maps the node data to the tree layout\n      // let nodes = this.ftree.nodesArray()\n\n      // adds each node as a group\n      var node = this.svgg.selectAll(\".nodeg\");\n\n      // remove nodes whose d is no longer in ftree\n      var keepNode = function keepNode(d) {\n        return Boolean(_this2.ftree.nodes[d.id]);\n      };\n      node.filter(function (d) {\n        return !keepNode(d);\n      }).remove();\n\n      node = node.filter(keepNode).data(this.ftree.nodesArray().filter(function (n) {\n        return !n.hidden;\n      }));\n      //disable action buttons during the transition\n      //node.on(\"mouseenter.actionButtons\",null)\n\n      // nodeEnter: all the new nodes\n      var nodeEnter = node.enter().append(\"g\").attr(\"id\", function (d) {\n        return FamilyTreeArtist.nodeGroupId(d.id);\n      }).attr(\"class\", \"nodeg\").attr(\"transform\", \"translate(\" + source.x + \",\" + source.y + \")\");\n\n      // fam nodes: add height salt, for a different branching height for all famc\n      var famNodes = nodeEnter.filter(function (d) {\n        return d.tag === \"FAM\";\n      });\n      famNodes.insert(\"circle\", \".nodeg\").attr(\"r\", self.kgp.famNodeSize.width / 2)\n      // add man/woman/family classes\n      .attr(\"class\", function (d) {\n        var tr = \"node-circle \";\n        // family classes: one for each member of the family\n        tr += d.husb ? FamilyTreeArtist.famNodeClass(d.husb.id) + \" \" : \"\";\n        tr += d.wife ? FamilyTreeArtist.famNodeClass(d.wife.id) + \" \" : \"\";\n        if (d.chil) {\n          d.chil.forEach(function (c) {\n            tr += FamilyTreeArtist.famNodeClass(c.id) + \" \";\n          });\n        }\n        return tr;\n      }).attr(\"fill\", \"lightgrey\");\n      famNodes.each(function (d) {\n        // @F1@ is special case: it is only famc whose wife and husb aren't targets in links\n        d.heightSalt = d.id == \"@F1@\" ? 0 : 15 - Math.random() * 30;\n      });\n\n      // nodes of individuals\n      var indiNodes = nodeEnter.filter(function (d) {\n        return d.tag === \"INDI\";\n      });\n      indiNodes.append(\"circle\").attr(\"r\", self.kgp.indiNodeSize.width / 2)\n      // add man/woman/family classes\n      .attr(\"class\", function (d) {\n        var tr = \"node-circle \";\n        if (d.sex == \"M\") {\n          tr += \" man\";\n        } else if (d.sex == \"F\") {\n          tr += \" woman\";\n        }\n        return tr;\n      });\n      // draw buttons on mouseenter&click\n      indiNodes.on(\"mouseenter.actionButtons\", function (node) {\n        return self.nodeButtons.wake(node);\n      });\n      indiNodes.on(\"click.actionButtons\", function (node) {\n        return self.nodeButtons.wake(node);\n      });\n      // add buttons to nodes\n      indiNodes.each(function (d) {\n        d.buttons = _NodeButtonsGroup.standardNodeButtons;\n      });\n\n      // adds the DNA logo\n      indiNodes.append(\"text\").attr(\"class\", \"fas fa-dna dna-logo node-logo node-logo-large\").classed(\"invisible-dna\", function (d) {\n        return !d.sequencedDNA;\n      }).attr(\"x\", \"-16px\").attr(\"y\", \" 0px\").attr(\"width\", \"40px\").attr(\"height\", \"40px\").attr('font-family', 'FontAwesome').attr('font-size', \"36px\").text(\"\\uF471\");\n\n      // Node name: a div that has contenteditable\n      indiNodes.append(\"foreignObject\").attr(\"x\", \"-40px\").attr(\"y\", \"14px\").attr(\"width\", \"80px\").attr(\"height\", \"2em\").append(\"xhtml:div\").attr(\"contenteditable\", \"true\").attr(\"class\", \"node-name\").attr(\"spellcheck\", \"false\")\n      // select all text on focus\n      .on(\"focus\", function (d) {\n        var el = this;\n        requestAnimationFrame(function () {\n          var range = document.createRange();\n          range.selectNodeContents(el);\n          var sel = window.getSelection();\n          sel.removeAllRanges();\n          sel.addRange(range);\n        });\n      }).each(function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(d) {\n          var nodeNameMan, nodeNameWoman, nodeNameYou;\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return self.i18n.t(\"node-name-man\");\n\n                case 2:\n                  nodeNameMan = _context2.sent;\n                  _context2.next = 5;\n                  return self.i18n.t(\"node-name-woman\");\n\n                case 5:\n                  nodeNameWoman = _context2.sent;\n                  _context2.next = 8;\n                  return self.i18n.t(\"node-name-you\");\n\n                case 8:\n                  nodeNameYou = _context2.sent;\n\n                  if (Boolean(d.name) & d.name != nodeNameMan & d.name != nodeNameWoman) {\n                    // only set innerHTML if the name is truly non-standard\n                    this.innerHTML = d.name;\n                  } else if (d.name != nodeNameYou & this.getAttribute(self.i18n.keyAttr) != \"node-name-you\") {\n                    // only set self.i18n.keyAttr if it's not the \"you\" node\n                    //this.setAttribute(self.i18n.keyAttr, d.sex==\"F\"? \"node-name-woman\":\"node-name-man\")\n                    this.setAttribute(self.i18n.keyAttr, \"node-name-\" + d.i18nName);\n                  }\n                  // remove i18n attribute on keydown and quit name editing on enter\n                  // using addEventListener and not d3.on() as accessing the event \n                  // with d3.event might cause problem with webpack/bundler\n                  this.addEventListener(\"keydown\", function (event) {\n                    this.removeAttribute(self.i18n.keyAttr);\n                    d.name = this.innerHTML;\n                    self.kgp.saveFamilyTreeToLocalStorage();\n                    // if line return: remove selection and unselect element\n                    if (event.keyCode == 13) {\n                      window.getSelection().removeAllRanges();\n                      this.blur();\n                    }\n                    return false;\n                  });\n\n                case 11:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        return function (_x5) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n\n      // old&new nodes together\n      var nodeUpdate = nodeEnter.merge(node);\n      // hide families with only 1 spouse\n      nodeUpdate.filter(function (d) {\n        return d.tag === \"FAM\";\n      }).classed(\"hidden\", function (d) {\n        return !(d.wife && d.husb);\n      });\n      // highlight links\n      nodeUpdate.on(\"mouseenter.toggleHighlightNodeLinks\", self.generateToggleHighlightNodeLinks(true));\n      nodeUpdate.on(\"mouseleave.toggleHighlightNodeLinks\", self.generateToggleHighlightNodeLinks(false));\n      // transition nodes to new positions smoothly\n      nodeUpdate.transition().duration(transitionsDuration).attr(\"transform\", function (d) {\n        return \"translate(\" + d.x + \",\" + d.y + \")\";\n      });\n    }\n  }, {\n    key: \"setAsTarget\",\n    value: function setAsTarget(newTarget, oldTarget) {\n      this.nodeButtons.hide();\n      // reset old target's buttons, logo & sequenced state\n      if (oldTarget) {\n        oldTarget.buttons = oldTarget.id == this.kgp.youNodeId ? _NodeButtonsGroup.youNodeButtons : _NodeButtonsGroup.standardNodeButtons;\n        d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(oldTarget.id) + \" .node-logo\").attr(\"class\", \"fas fa-dna dna-logo node-logo node-logo-large \" + (oldTarget.lastSequencedDNA ? \"\" : \"invisible-dna\")).attr(\"x\", \"-16px\").text(\"\\uF471\");\n        oldTarget.sequencedDNA = oldTarget.lastSequencedDNA;\n        oldTarget.lastSequencedDNA = undefined;\n      }\n      // set new target\n      newTarget.buttons = newTarget.id == this.kgp.youNodeId ? _NodeButtonsGroup.youTargetNodeButtons : _NodeButtonsGroup.targetNodeButtons;\n      // ...ensure it's not sequenced\n      newTarget.lastSequencedDNA = newTarget.sequencedDNA;\n      newTarget.sequencedDNA = false;\n      //nodeg.select(\".dna-logo\").classed(\"invisible-dna\", !node.sequencedDNA)\n\n      // change the logo\n      d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(newTarget.id) + \" .node-logo\").attr(\"class\", \"fas fa-crosshairs crosshairs-logo node-logo node-logo-large\").attr(\"x\", \"-18px\").text(\"\\uF05B\");\n    }\n  }, {\n    key: \"initNodeButtons\",\n    value: function initNodeButtons() {\n\n      // TODO: this is not super clean, in the future improve the architecture of addRelativeMenu()\n      var addRelativeMenu = function () {\n        var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(node) {\n          var canAddChildren, canAddParents, canAddMother, canAddFather, spouseMissing, FOw, FOh, FOx, FOy, hitboxMargin, addRelativeHitbox, addRelativeFO, addRelativeDiv, _addAddRelativeSpan;\n\n          return regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  _addAddRelativeSpan = function _addAddRelativeSpan(relative, addRelative) {\n                    addRelativeDiv.append(\"span\").attr(self.i18n.keyAttr, \"node-name-\" + relative).on(\"click\", function (node) {\n                      var relativeNode = addRelative(node);\n                      relativeNode.i18nName = self.kgp.relationToYou(node.i18nName, relative);\n                      self.update(node);\n                      self.nodeButtons.hide();\n                      addRelativeHitbox.remove();\n                      self.kgp.saveFamilyTreeToLocalStorage();\n                    });\n                  };\n\n                  //fix: node doesn't propagate to circle\n                  node = self.nodeButtons.g.datum();\n                  removeAddRelativeMenu();\n\n                  // can only add children/parents if tree not too deep\n                  canAddChildren = node.depth < self.kgp.options.maxFamilyTreeDepth - 1;\n                  canAddParents = self.ftree.maxDepth < self.kgp.options.maxFamilyTreeDepth - 1 || node.depth != 0;\n                  canAddMother = (!node.famc || !node.famc.wife) && canAddParents;\n                  canAddFather = (!node.famc || !node.famc.husb) && canAddParents;\n                  spouseMissing = !node.fams || node.fams.length == 0 || !node.fams[0].husb || !node.fams[0].wife;\n                  // FO stands for foreignObject\n\n                  FOw = 100;\n                  FOh = ((canAddChildren ? 2 : 0) + canAddMother + canAddFather + spouseMissing) * 26;\n                  FOx = 20;\n                  FOy = -(FOh / 2);\n                  hitboxMargin = 20;\n\n                  // hitbox so that menu doesn't disappear unexpectedly\n\n                  addRelativeHitbox = addRelativeButton.append(\"path\").classed(\"add-relatives-hitbox\", true).attr(\"d\", \" M\" + (FOx - 2 * hitboxMargin) + \" \" + -hitboxMargin + \" L\" + FOx + \" \" + (FOy - hitboxMargin) + \" L\" + (FOx + FOw + hitboxMargin) + \" \" + (FOy - hitboxMargin) + \" L\" + (FOx + FOw + hitboxMargin) + \" \" + (-FOy + hitboxMargin) + \" L\" + FOx + \" \" + (-FOy + hitboxMargin) + \" L\" + (FOx - 2 * hitboxMargin) + \" \" + hitboxMargin + \" Z\").attr(\"fill\", \"red\").attr(\"opacity\", 0);\n                  addRelativeFO = addRelativeButton.append(\"foreignObject\").classed(\"add-relatives-fo\", true).attr(\"x\", FOx + \"px\").attr(\"y\", FOy + \"px\").attr(\"width\", FOw + 10 + \"px\").attr(\"height\", FOh + 10 + \"px\");\n                  addRelativeDiv = addRelativeFO.append(\"xhtml:div\").attr(\"style\", \"cursor:pointer;\").classed(\"add-relatives-list\", true).on(\"mouseleave.hitbox\", removeAddRelativeMenu);\n\n\n                  if (canAddMother) {\n                    _addAddRelativeSpan(\"mother\", function (d) {\n                      return self.ftree.addParent(\"\", \"F\", d.id);\n                    }, true);\n                  }\n                  if (canAddFather) {\n                    _addAddRelativeSpan(\"father\", function (d) {\n                      return self.ftree.addParent(\"\", \"M\", d.id);\n                    }, true);\n                  }\n                  if (spouseMissing & node.sex == \"M\") {\n                    _addAddRelativeSpan(\"partner\", function (d) {\n                      return self.ftree.addSpouse(\"\", d.id);\n                    }, true);\n                  }\n                  if (spouseMissing & node.sex == \"F\") {\n                    _addAddRelativeSpan(\"partner\", function (d) {\n                      return self.ftree.addSpouse(\"\", d.id);\n                    }, true);\n                  }\n                  if (canAddChildren) {\n                    _addAddRelativeSpan(\"daughter\", function (d) {\n                      return self.ftree.addChild(\"\", \"F\", d.id, false);\n                    }, true);\n                  }\n                  if (canAddChildren) {\n                    _addAddRelativeSpan(\"son\", function (d) {\n                      return self.ftree.addChild(\"\", \"M\", d.id, false);\n                    }, true);\n                  }\n\n                case 22:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3, this);\n        }));\n\n        return function addRelativeMenu(_x6) {\n          return _ref3.apply(this, arguments);\n        };\n      }();\n\n      var self = this;\n      this.nodeButtons = new _NodeButtonsGroup.NodeButtonsGroup(this.svgg, self.kgp.indiNodeSize.width);\n      this.nodeButtons.hide();\n\n      // ------------------------ remove node button ------------------------\n      function removeNode(node) {\n        self.ftree.deleteNode(node.id, self.kgp.youNodeId);\n        self.nodeButtons.hide();\n        self.kgp.scoreRequestHandler.requestScore(self.kgp.target ? self.kgp.target.id : \"\", self.ftree.getLinksAsIds(), self.ftree.nodesArray().filter(function (n) {\n          return n.sequencedDNA;\n        }).map(function (n) {\n          return n.id;\n        }), self.kgp.userId, self.kgp.userSource, self.i18n.lng);\n        self.update();\n        self.kgp.saveFamilyTreeToLocalStorage();\n      }\n\n      self.nodeButtons.addButton(\"remove-node\", 25, -50, \"\\uF506\", \"80px\", \"50px\", self.i18n, \"hint-delete-node\").on(\"click.remove\", removeNode);\n\n      // ------------------------ toggle DNA sequencing button ------------------------\n\n\n      // HOW TO HANDLE +-: d =>'\\uf471'+(d.sequencedDNA?\"-\":\"+\") IN OLD CODE?\n      function toggleDnaButtonText(node) {\n        toggleDNAbutton.select(\"text\").node().innerHTML = \"\\uF471\" + (node.sequencedDNA ? \"-\" : \"+\");\n      }\n      function toggleDNA(node) {\n        node.sequencedDNA = !node.sequencedDNA;\n        toggleDnaButtonText(node);\n        d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(node.id) + \" .dna-logo\").classed(\"invisible-dna\", !node.sequencedDNA);\n        self.kgp.scoreRequestHandler.requestScore(self.kgp.target ? self.kgp.target.id : \"\", self.ftree.getLinksAsIds(), self.ftree.nodesArray().filter(function (n) {\n          return n.sequencedDNA;\n        }).map(function (n) {\n          return n.id;\n        }), self.kgp.userId, self.kgp.userSource, self.i18n.lng);\n        self.kgp.saveFamilyTreeToLocalStorage();\n      }\n      var toggleDNAbutton = self.nodeButtons.addButton(\"toggle-dna\", 25, 50, \"\\uF471+\", \"170px\", \"70px\", self.i18n, \"hint-sequence-node\").on(\"click.sequenced-dna\", toggleDNA);\n      self.nodeButtons.onWakeCallbacks.push(toggleDnaButtonText);\n\n      // ------------------------ set as target button ------------------------\n\n      self.nodeButtons.addButton(\"set-as-target\", -50, 0, \"\\uF05B\", \"120px\", \"45px\", self.i18n, \"change-target\", {\n        FAx: -10, FAy: 7,\n        tooltipx: \"-144px\"\n      }).on(\"click.set-as-target\", function (n) {\n        return self.kgp.selectTarget(n);\n      });\n\n      // ------------------------ add relatives button ------------------------\n      var addRelativeButton = self.nodeButtons.addButton(\"add-relative\", 50, 0, \"\\uF234\", 0, 0, self.i18n, undefined, {\n        FAx: -10, FAy: 6,\n        tooltipx: 0, tooltipy: 0\n      });\n      addRelativeButton.select(\"circle\").on(\"mouseover.addRelative\", addRelativeMenu);\n      addRelativeButton.select(\"text\").on(\"mouseover.addRelative\", addRelativeMenu);\n      // correctly remove add relative menu on hide&wake\n      function removeAddRelativeMenu() {\n        //setTimeout(d => {\n        addRelativeButton.select(\".add-relatives-fo\").remove();\n        addRelativeButton.select(\".add-relatives-hitbox\").remove();\n        //},20)\n      }\n      self.nodeButtons.onHideCallbacks.push(removeAddRelativeMenu);\n      //self.nodeButtons.onWakeCallbacks.push(removeAddRelativeMenu)\n\n\n      // ------------------------ Toggle your sex Button ------------------------\n      function toggleYourSex(node) {\n        var circle = d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(node.id) + \" .node-circle\");\n\n        node.sex = node.sex == \"M\" ? \"F\" : \"M\";\n        var isWoman = node.sex == \"F\";\n        circle.classed(\"man\", !isWoman);\n        circle.classed(\"woman\", isWoman);\n        // exchange role in marriages\n        if (node.fams) {\n          node.fams.forEach(function (f) {\n            var h = f.husb;\n            f.husb = f.wife;\n            f.wife = h;\n          });\n        }\n        // take care of spouse\n        var spouse = node.spouse();\n        if (spouse) {\n          spouse.sex = spouse.sex == \"M\" ? \"F\" : \"M\";\n          isWoman = spouse.sex == \"F\";\n          var spouseCircle = d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(spouse.id) + \" .node-circle\");\n          spouseCircle.classed(\"man\", !isWoman);\n          spouseCircle.classed(\"woman\", isWoman);\n          //document.querySelector(\"#\"+nodeGroupId(spouse.id)+\" .node-name\").setAttribute(i18n.keyAttr, isWoman? \"node-name-woman\":\"node-name-man\")\n        }\n        self.kgp.saveFamilyTreeToLocalStorage();\n      }\n      self.nodeButtons.addButton(\"change-sex\", -25, 50, \"\\uF228\", 80, 45, self.i18n, \"hint-change-sex\", {\n        FAx: -10, FAy: 6,\n        tooltipx: -104\n      }).on(\"click.change-sex\", toggleYourSex);\n    }\n  }, {\n    key: \"generateToggleHighlightNodeLinks\",\n    value: function generateToggleHighlightNodeLinks(active) {\n      return function toggleHighlightNodeLinks(d) {\n        var links = [d.id, d.famc ? d.famc.id : undefined, d.fams && d.fams.length > 0 ? d.fams[0].id : undefined].filter(Boolean);\n        links.map(FamilyTreeArtist.linkNodeClass).forEach(function (l) {\n          var links = d3.selectAll(\".\" + l);\n          links.classed(\"highlight-link\", active);\n        });\n\n        if (d.famc) {\n          d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(d.famc.id) + \" .node-circle\").classed(\"highlight-fam\", active);\n        }\n        if (d.fams && d.fams.length > 0) {\n          d3.select(\"#\" + FamilyTreeArtist.nodeGroupId(d.fams[0].id) + \" .node-circle\").classed(\"highlight-fam\", active);\n        }\n      };\n    }\n  }], [{\n    key: \"idToString\",\n    value: function idToString(id) {\n      return id ? id.replace(/@/g, \"\") : \"\";\n    }\n  }, {\n    key: \"linkNodeId\",\n    value: function linkNodeId(id1, id2) {\n      return \"link-\" + FamilyTreeArtist.idToString(id1) + \"-\" + FamilyTreeArtist.idToString(id2);\n    }\n  }, {\n    key: \"linkNodeClass\",\n    value: function linkNodeClass(id) {\n      return \"link-\" + FamilyTreeArtist.idToString(id);\n    }\n  }, {\n    key: \"famNodeClass\",\n    value: function famNodeClass(id) {\n      return \"fam-\" + FamilyTreeArtist.idToString(id);\n    }\n  }, {\n    key: \"nodeGroupId\",\n    value: function nodeGroupId(id) {\n      return \"node-\" + FamilyTreeArtist.idToString(id);\n    }\n  }, {\n    key: \"renderCurvedLink\",\n    value: function renderCurvedLink(source, target) {\n      return \"M\" + source.x + \",\" + source.y + \"C\" + source.x + \",\" + (source.y + target.y) / 2 + \" \" + target.x + \",\" + (source.y + target.y) / 2 + \" \" + target.x + \",\" + target.y;\n    }\n  }, {\n    key: \"renderSquareLink\",\n    value: function renderSquareLink(source, target) {\n      var heightSalt = source.heightSalt ? source.heightSalt : 0;\n      return \"M\" + source.x + \",\" + source.y + \"L\" + source.x + \",\" + (heightSalt + (source.y + target.y) / 2) + \"L\" + target.x + \",\" + (heightSalt + (source.y + target.y) / 2) + \"L\" + target.x + \",\" + target.y;\n    }\n  }, {\n    key: \"renderLink\",\n    value: function renderLink(source, target) {\n      return FamilyTreeArtist.renderSquareLink(source, target);\n    }\n  }]);\n\n  return FamilyTreeArtist;\n}();\n\n//# sourceURL=webpack:///./app/src/js/FamilyTreeArtist.js?");

/***/ }),

/***/ "./app/src/js/FamilyTreeLayout.js":
/*!****************************************!*\
  !*** ./app/src/js/FamilyTreeLayout.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FamilyTreeLayout = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _FamilyTree2 = __webpack_require__(/*! ./FamilyTree.js */ \"./app/src/js/FamilyTree.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar FamilyTreeLayout = exports.FamilyTreeLayout = function (_FamilyTree) {\n  _inherits(FamilyTreeLayout, _FamilyTree);\n\n  function FamilyTreeLayout(nodes, centerNodeId) {\n    _classCallCheck(this, FamilyTreeLayout);\n\n    // if no centerNodeId, set it as the first family with 2 spouses\n    var _this = _possibleConstructorReturn(this, (FamilyTreeLayout.__proto__ || Object.getPrototypeOf(FamilyTreeLayout)).call(this, nodes));\n\n    if (!centerNodeId) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = Object.keys(nodes)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var n = _step.value;\n\n          if (nodes[n].tag === \"FAM\" & (nodes[n].husb != undefined | nodes[n].wife != undefined)) // only 1 spouse\n            centerNodeId = nodes[n].id;\n          if (nodes[n].tag === \"FAM\" & nodes[n].husb != undefined & nodes[n].wife != undefined) {\n            centerNodeId = nodes[n].id;\n            break;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n    _this.centerNode = _this.nodes[centerNodeId];\n\n    //compute nodes positions\n    //this.computeLayout()\n    return _this;\n  }\n\n  _createClass(FamilyTreeLayout, [{\n    key: \"serialize\",\n\n\n    /** Serializes FamilyTree layout to a JSON ready JS Object\n     * Only need to call JSON.stringify() to transform it to string.\n     * @returns {Object} {\n     *   class : \"FamilyTreeLayout\", // Class of the object\n     *   nodes : nodes, // nodes in an array with ids as links\n     *   properties : properties // the list of properties the nodes have\n     *   centerNodeId : centerNodeId // the id of the node around which the layout is organized\n     * }\n     */\n    value: function serialize() {\n      var properties = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      var serialization = FamilyTreeLayout.parentClass().serialize.call(this, properties);\n      serialization.class = \"FamilyTreeLayout\";\n      serialization.centerNodeId = this.centerNode ? this.centerNode.id : 0;\n      return serialization;\n    }\n    /** Inverse of JSON.stringify(FamilyTreeLayout.serialize())\n     * @param {string} serializedFtreeLayout\n     * @returns {FamilyTreeLayout}\n     */\n\n  }, {\n    key: \"computeLayout\",\n\n\n    /**\n    Function computing x&y positions for each node\n     the idea is:\n    a) massage the family tree in a good input format for d3-pedigree-tree to do the layout\n    b) then massage the output back in a proper layout for the family tree.\n     step a):\n    1) wives and husbands are filtered out\n    2) their fams node takes their parents families (both famc) as their parents\n    3) individual node take as parent their famc\n    4) nodes without parents and at depth>0 are given dummy-parents so that d3-pedigree layouts them at the right depth\n    5) we give those nodes to d3-pedigree-tree\n     step b):\n    1) invert x&y values (d3-pedigree-tree makes an horizontal layout)\n    */\n    value: function computeLayout() {\n      var _this2 = this;\n\n      var nodes = this.nodesArray();\n      this._computeDepths(nodes[0]);\n\n      var indiNodes = nodes.filter(function (n) {\n        return n.tag == \"INDI\";\n      });\n      var dummyNodeId = 0;\n      var dummyNodes = [];\n      indiNodes.forEach(function (n) {\n        delete n.parents;\n      });\n      indiNodes.forEach(function (n) {\n        var spouse = n.spouse() || {};\n        if (spouse.parents) {\n          // parents are the same for both spouses\n          n.parents = spouse.parents;\n        } else {\n          if (!n.famc && !spouse.famc) {\n            // if no ancestors for both parents: give them a virtual ancestor\n            for (var i = -1; i < n.depth; i++) {\n              var dummyParents = i != -1 ? [dummyNodes[dummyNodeId - 1]] : [];\n              dummyNodes.push({ id: \"@D\" + dummyNodeId + \"@\", depth: i, parents: dummyParents });\n              dummyNodeId++;\n            }\n            n.parents = [dummyNodes[dummyNodeId - 1]];\n          } else {\n            // otherwise, the ancestors are both spouses' parents\n            n.parents = n.famc ? [n.famc.wife, n.famc.husb] : [];\n            if (spouse && spouse.famc) {\n              n.parents.push(spouse.famc.wife);\n              n.parents.push(spouse.famc.husb);\n            }\n            n.parents = n.parents.filter(Boolean);\n          }\n        }\n        // couples without children must have a virtual kid to get them together\n        if (n.spouse() && (!n.fams[0].chil || n.fams[0].chil.length == 0)) {\n          dummyNodes.push({ id: \"@D\" + dummyNodeId + \"@\", depth: n.depth + 1, parents: [n, spouse] });\n          dummyNodeId++;\n        }\n      });\n      indiNodes = indiNodes.concat(dummyNodes);\n      // ========= sort nodes by x factor\n      indiNodes.sort(function (a, b) {\n        var ax = a.x ? a.x : 0;\n        var bx = b.x ? b.x : 0;\n        return ax - bx;\n      });\n\n      var tree = d3.pedigreeTree().levelWidth(150).nodePadding(120).linkPadding(25).parents(function (d) {\n        return d.parents;\n      }).groupChildless(false).iterations(300).data(indiNodes);\n\n      var treepp = tree();\n      treepp.nodes.forEach(function (node) {\n        if (_this2.nodes[node.id]) {\n          _this2.nodes[node.id].x = node.y;\n          _this2.nodes[node.id].y = node.x;\n        }\n      });\n      /*console.log(\"treepp.nodes\")\n      console.log(treepp.nodes)\n      console.log(\"nodes\")\n      console.log(nodes)*/\n\n      // position marriages\n      var famNodes = nodes.filter(function (d) {\n        return d.tag === \"FAM\";\n      });\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = famNodes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var fam = _step2.value;\n\n          if (fam.wife && fam.husb) {\n            fam.x = (fam.wife.x + fam.husb.x) / 2;\n            fam.y = fam.wife.y;\n          } else {\n            var spouse = [fam.wife, fam.husb].filter(Boolean)[0];\n            if (spouse) {\n              fam.x = spouse.x;\n              fam.y = spouse.y;\n            }\n          }\n        }\n\n        // spouses can be reverted -> sort them according to famc.x\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = nodes.filter(function (d) {\n          return d.tag === \"INDI\";\n        })[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var indi = _step3.value;\n\n          var spouse = indi.spouse();\n          if (indi.famc && spouse && spouse.famc) {\n            if (indi.x > spouse.x && indi.famc.x < spouse.famc.x) {\n              var tempx = indi.x;\n              indi.x = spouse.x;\n              spouse.x = tempx;\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n    }\n\n    /*\n    Re-centers the graph. position 0,0 is in the middle of all nodes position\n    */\n\n  }, {\n    key: \"center\",\n    value: function center() {\n      var horizontal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var vertical = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n      var xoffset = -(this.minX() + this.maxX()) / 2;\n      var yoffset = -(this.minY() + this.maxY()) / 2;\n      _.forEach(this.nodes, function (n) {\n        n.x += horizontal ? xoffset : 0;\n        n.y += vertical ? yoffset : 0;\n      });\n      return this;\n    }\n  }, {\n    key: \"width\",\n    value: function width() {\n      var extent = d3.extent(_.map(this.nodes, function (n) {\n        return n.x;\n      }));\n      return extent[1] - extent[0];\n    }\n  }, {\n    key: \"height\",\n    value: function height() {\n      var extent = d3.extent(_.map(this.nodes, function (n) {\n        return n.y;\n      }));\n      return extent[1] - extent[0];\n    }\n  }, {\n    key: \"minX\",\n    value: function minX() {\n      return d3.min(_.map(this.nodes, function (n) {\n        return n.x;\n      }));\n    }\n  }, {\n    key: \"minY\",\n    value: function minY() {\n      return d3.min(_.map(this.nodes, function (n) {\n        return n.y;\n      }));\n    }\n  }, {\n    key: \"maxX\",\n    value: function maxX() {\n      return d3.max(_.map(this.nodes, function (n) {\n        return n.x;\n      }));\n    }\n  }, {\n    key: \"maxY\",\n    value: function maxY() {\n      return d3.max(_.map(this.nodes, function (n) {\n        return n.y;\n      }));\n    }\n  }], [{\n    key: \"parentClass\",\n    value: function parentClass() {\n      return _FamilyTree2.FamilyTree.prototype;\n    }\n  }, {\n    key: \"unserialize\",\n    value: function unserialize(serializedFtreeLayout) {\n      serializedFtreeLayout = JSON.parse(serializedFtreeLayout);\n      return new FamilyTreeLayout(_FamilyTree2.FamilyTree.unserializeParseNodes(serializedFtreeLayout), serializedFtreeLayout.centerNodeId);\n    }\n  }]);\n\n  return FamilyTreeLayout;\n}(_FamilyTree2.FamilyTree);\n\n//# sourceURL=webpack:///./app/src/js/FamilyTreeLayout.js?");

/***/ }),

/***/ "./app/src/js/KgpBackendStatus.js":
/*!****************************************!*\
  !*** ./app/src/js/KgpBackendStatus.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpBackendStatus = exports.KgpBackendStatus = function () {\n  function KgpBackendStatus(parentId, i18n) {\n    _classCallCheck(this, KgpBackendStatus);\n\n    this.parentId = parentId;\n    this.i18n = i18n;\n\n    this.init();\n  }\n\n  _createClass(KgpBackendStatus, [{\n    key: \"init\",\n    value: function init() {\n      document.getElementById(this.parentId).innerHTML = ' \\\n    <div class=\"alert\" style=\"display:none\"><div class=\"kgp-alert-content\"></div></div> ';\n      /*\n      <div class=\"alert alert-success\" style=\"display:none\" id=\"response-success\"><div class=\"alert-content\" data-i18n=\"response-success\"></div></div>\n      <div class=\"alert alert-info\" style=\"display:none\" id=\"response-info\"><div class=\"alert-content\"></div></div>\n      <div class=\"alert alert-warning\" style=\"display:none\" id=\"response-warning\"><div class=\"alert-content\"></div></div>\n      <div class=\"alert alert-danger\" style=\"display:none\" id=\"response-danger\"><div class=\"alert-content\"></div></div>\n      '*/\n      this.element = $(\"#\" + this.parentId + \" .alert\");\n      this.content = $(\"#\" + this.parentId + \" .kgp-alert-content\");\n      this.i18n.dynamic[\"response-success\"] = this.i18nFormatSuccessMessage;\n    }\n\n    /** await() puts the KgpBackendStatus in a waiting state and updates it properly once the promise has fulfilled */\n\n  }, {\n    key: \"await\",\n    value: function _await(kgpPromise, request, previousResponse) {\n      var self = this;\n      this.displayOngoing();\n      return kgpPromise.then(function (kgpSuccess) {\n        // success\n        var same_signature = previousResponse.tree_signature == kgpSuccess.tree_signature;\n        self.displaySuccess(kgpSuccess.result.privacy_metric, kgpSuccess.result.execution_time, kgpSuccess.result.cached, same_signature);\n      }).catch(function (kgpError) {\n        if (kgpError.status == \"error\") {\n          // error code 2\n          if (kgpError.code == 2) {\n            self.displayDanger(\"response-error-\" + kgpError.code);\n            self.i18n.data(\"response-error-2\", [kgpError.extras.error_identifier]);\n          }\n          // error code 4\n          else if (kgpError.code == 4) {\n              self.displayInfo(\"response-error-4\", 100000);\n            }\n            // error code 5\n            else if (kgpError.code == 5) {\n                self.displayDanger(\"response-error-5\");\n              }\n              // other error codes\n              else {\n                  self.displayWarning(\"response-error-\" + kgpError.code);\n                }\n        }\n      });\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      // Hide the previous alert + explainer\n      this.content.attr(this.i18n.dataAttr, null);\n      this.element.stop(true).hide().removeClass(\"alert-success alert-info alert-warning alert-danger\");\n    }\n\n    /** Display the result message from the server */\n\n  }, {\n    key: \"displayMessage\",\n    value: function displayMessage(type, messageKey, timeout) {\n      this.hide();\n      this.element.addClass(\"alert-\" + type);\n      this.content.attr(this.i18n.keyAttr, messageKey);\n      this.element.stop(true).slideDown(500).fadeTo(timeout, 500).slideUp(500);\n    }\n  }, {\n    key: \"displayOngoing\",\n    value: function displayOngoing() {\n      this.hide();\n      this.element.addClass(\"alert-warning\");\n      this.content.attr(this.i18n.keyAttr, \"response-ongoing\");\n      this.element.slideDown(500);\n    }\n  }, {\n    key: \"displayWarning\",\n    value: function displayWarning(messageKey) {\n      var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n\n      this.displayMessage(\"warning\", messageKey, timeout);\n    }\n  }, {\n    key: \"displayInfo\",\n    value: function displayInfo(messageKey) {\n      var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n\n      this.displayMessage(\"info\", messageKey, timeout);\n    }\n  }, {\n    key: \"displayDanger\",\n    value: function displayDanger(errorKey) {\n      var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n\n      this.displayMessage(\"danger\", errorKey, timeout);\n    }\n  }, {\n    key: \"displaySuccess\",\n    value: function displaySuccess(score, time, cached, similar) {\n      var timeout = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 5000;\n\n      this.hide();\n      this.element.addClass(\"alert-success\");\n      this.content.attr(this.i18n.keyAttr, \"response-success\");\n      this.i18n.data(\"response-success\", {\n        time: time.toFixed(2),\n        cached: cached,\n        similar: similar\n      });\n      this.element.stop(true).slideDown(500).fadeTo(timeout, 500).slideUp(500);\n    }\n\n    /** success formatter function for i18n */\n\n  }, {\n    key: \"i18nFormatSuccessMessage\",\n    value: function i18nFormatSuccessMessage(text, data) {\n      //\"Réponse calculée en {#1} secondes{#2 (en cache)}.{#3 Le score est inchangé, <a href='../faq#change' target='_blank'>en savoir plus</a>.}\",\n      text = text.replace(\"{#1}\", data.time);\n      text = text.replace(/{#2(.+?)}/, data.cached ? \"$1\" : \"\");\n      text = text.replace(/{#3(.+?)}/, data.similar ? \"$1\" : \"\");\n      return text;\n    }\n  }]);\n\n  return KgpBackendStatus;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KgpBackendStatus.js?");

/***/ }),

/***/ "./app/src/js/KgpIframeInterface.js":
/*!******************************************!*\
  !*** ./app/src/js/KgpIframeInterface.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.kgpSetSourceEvent = kgpSetSourceEvent;\nexports.kgpSetLanguageEvent = kgpSetLanguageEvent;\nexports.kgpSetIframeMaxDimensionEvent = kgpSetIframeMaxDimensionEvent;\nexports.kgpLaunchTutorialEvent = kgpLaunchTutorialEvent;\nexports.kgpSetHeightEvent = kgpSetHeightEvent;\n\nvar _cookies = __webpack_require__(/*! ./lib/cookies.js */ \"./app/src/js/lib/cookies.js\");\n\nvar cl = console.log;\n\n/******** down events ********/\n\nfunction kgpSetSourceEvent(source) {\n  return new CustomEvent(\"KgpSetSourceEvent\", { detail: { source: source } });\n}\n\nfunction kgpSetLanguageEvent(lng) {\n  return new CustomEvent(\"KgpSetLanguageEvent\", { detail: { lng: lng } });\n}\n\n/** Event from kgpmeter to kgp-iframe to signale iframe max dimensions */\nfunction kgpSetIframeMaxDimensionEvent(maxHeight) {\n  return new CustomEvent(\"KgpSetIframeMaxDimensionEvent\", { detail: { maxHeight: maxHeight } });\n}\n\nfunction kgpLaunchTutorialEvent() {\n  return new CustomEvent(\"KgpLaunchTutorialEvent\");\n}\n\n/******** up events ********/\n\n/** Event from kgp-iframe to kgpmeter to change height */\nfunction kgpSetHeightEvent(height, transitionDuration) {\n  return new CustomEvent(\"KgpSetHeightEvent\", { \"detail\": { \"height\": height, \"transitionDuration\": transitionDuration } });\n}\n\n//# sourceURL=webpack:///./app/src/js/KgpIframeInterface.js?");

/***/ }),

/***/ "./app/src/js/KgpPrivacyBar.js":
/*!*************************************!*\
  !*** ./app/src/js/KgpPrivacyBar.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpPrivacyBar = exports.KgpPrivacyBar = function () {\n  function KgpPrivacyBar(parentId, id, x, y, width, height, r, colorScale, i18n) {\n    var nbBoxes = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 5;\n    var strokeWidth = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : 4;\n    var elementClass = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : \"privacy-bar-element\";\n    var backgroundColor = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : \"rgb(230,230,230)\";\n\n    _classCallCheck(this, KgpPrivacyBar);\n\n    this.parentId = parentId;\n    this.id = id;\n    this.width = width;\n    this.height = height;\n    this.r = r;\n    this.nbBoxes = nbBoxes;\n    this.strokeWidth = strokeWidth;\n    this.colorScale = colorScale;\n    this.elementClass = elementClass;\n    this.backgroundColor = backgroundColor;\n    this.privacyStatus = 1;\n    this.i18n = i18n;\n\n    this.init(x, y, 0);\n  }\n\n  _createClass(KgpPrivacyBar, [{\n    key: \"init\",\n    value: function init(x, y) {\n      var transitionDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 500;\n\n      if (x || x === 0) {\n        this.x = x;\n      }\n      if (y || y === 0) {\n        this.y = y;\n      }\n\n      var self = this;\n      this.g = d3.select(\"#\" + this.parentId).append(\"g\").attr(\"transform\", \"translate(\" + self.x + \",\" + self.y + \")\").attr(\"id\", this.id);\n\n      var startColor = this.colorScale(1);\n      var barBasis = '<rect x=\"0\" y=\"0\" rx=\"' + this.r + '\" ry=\"' + this.r + '\" height=\"' + this.height + '\" width=\"' + this.width + '\"';\n      this.g.html(barBasis + ' fill=\"' + this.backgroundColor + '\" class=\"privacy-bar-background ' + this.elementClass + '\"/>' + barBasis + ' fill=\"' + startColor + '\" class=\"privacy-bar ' + this.elementClass + '\" />');\n      this.bar = this.g.select(\".privacy-bar\");\n\n      var boxSize = this.height / this.nbBoxes;\n      var yboxes = d3.range(0, this.height, boxSize);\n      this.boxesG = this.g.append(\"g\").attr(\"id\", \"privacy-bar-contour-group\");\n      this.boxesG.selectAll(\"rect\").data(yboxes).enter().append(\"rect\").attr(\"class\", \"privacy-bar-contour\").attr(\"x\", \"0\").attr(\"y\", function (d) {\n        return d;\n      }).attr(\"rx\", 5).attr(\"ry\", 5).attr(\"width\", this.width).attr(\"height\", boxSize).attr(\"fill\", \"none\").attr(\"stroke\", \"white\").attr(\"stroke-width\", this.strokeWidth + 'px');\n\n      this.g.append(\"text\").attr(\"x\", +this.width).attr(\"y\", -16).attr(\"height\", 20).attr(\"text-anchor\", \"end\").attr(\"fill\", \"darkgrey\").attr(\"id\", \"privacy-bar-title\").attr(\"class\", this.elementClass).attr(this.i18n.keyAttr, \"privacy-bar-title\");\n      this.scale = d3.scaleLinear().range([this.height, 0]).domain([0, 1]);\n\n      if (this.showScoreValue) {\n        this.scoreG = this.g.append(\"g\").attr(\"transform\", \"translate(0,3)\").attr(\"id\", \"privacy-score\");\n        this.scoreG.html('<polygon points=\"-10,-6 -4,0 -10,6\" fill=\"' + startColor + '\"/>' + '<text x=\"-14\" y=\"5\" fill=\"black\" text-anchor=\"end\">100%</text> <!--uncomment to see privacy-score value-->');\n        this.scorePolygon = d3.select(\"#privacy-score polygon\");\n        this.text = d3.select(\"#privacy-score text\");\n      }\n\n      this.elements = d3.selectAll(\".\" + this.elementClass);\n      this.update(1, transitionDuration);\n    }\n\n    /** update() updates the KgpPrivacyBar with a new score */\n\n  }, {\n    key: \"update\",\n    value: function update(privacyMeasure) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n\n      this.privacyStatus = privacyMeasure;\n      var transition = d3.transition().duration(transitionDuration).ease(function (t) {\n        return d3.easeBackOut(t, 0.8);\n      });\n      this.bar.transition(transition).attr(\"fill\", this.colorScale(privacyMeasure)).attr(\"y\", this.scale(privacyMeasure)).attr(\"height\", this.height - this.scale(this.privacyStatus));\n\n      this.elements.transition(200).attr(\"opacity\", 1);\n      // show score value\n      if (this.showScoreValue) {\n        this.scoreG.transition(transition) //d3.easeBackOut)//d3.easeExpInOut)//d3.easeCubicIn)\n        .attr(\"transform\", \"translate(0,\" + Math.max(this.scale(privacyMeasure), 4) + \")\");\n        this.scorePolygon.transition(transition).attr(\"fill\", this.colorScale(privacyMeasure));\n        this.text.html((100 * privacyMeasure).toFixed(0) + \"%\");\n      }\n    }\n\n    /** await() puts the KgpPrivacyBar in a waiting state (opacity=0.5) and updates it properly once the promise has fulfilled */\n\n  }, {\n    key: \"await\",\n    value: function _await(kgpPromise, request, previousResponse) {\n      var _this = this;\n\n      this.elements.transition(200).attr(\"opacity\", 0.5);\n      kgpPromise.then(function (kgpSuccess) {\n        _this.update(kgpSuccess.result.privacy_metric);\n      }).catch(function (kgpr) {\n        if (kgpr.status == \"error\") {\n          if (kgpr.code == 4) {\n            _this.elements.transition(200).attr(\"opacity\", 1);\n          }\n        }\n      });\n    }\n  }]);\n\n  return KgpPrivacyBar;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KgpPrivacyBar.js?");

/***/ }),

/***/ "./app/src/js/KgpScoreNumberExplainer.js":
/*!***********************************************!*\
  !*** ./app/src/js/KgpScoreNumberExplainer.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpScoreNumberExplainer = exports.KgpScoreNumberExplainer = function () {\n  function KgpScoreNumberExplainer(parentId, i18n, i18nKey) {\n    _classCallCheck(this, KgpScoreNumberExplainer);\n\n    this.parentId = parentId;\n    this.i18n = i18n;\n    this.i18nKey = i18nKey;\n    this.parent = $(\"#\" + this.parentId);\n\n    this.init();\n  }\n\n  _createClass(KgpScoreNumberExplainer, [{\n    key: \"init\",\n    value: function init() {\n      this.parent.html('<div class=\"alert alert-info text-justified\"> \\\n      <i class=\"far fa-lightbulb\"></i> \\\n      <span class=\"kgp-explainer-text\"></span> \\\n    </div>');\n      this.div = $(\"#\" + this.parentId + \" .alert\").hide();\n      this.text = $(\"#\" + this.parentId + \" .kgp-explainer-text\").attr(this.i18n.keyAttr, this.i18nKey);\n\n      this.i18n.dynamic[this.i18nKey] = this.i18nFormat;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.div.stop(true).slideUp(500);\n    }\n  }, {\n    key: \"update\",\n    value: function update(privacyMeasure) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n\n      this.i18n.data(this.i18nKey, { privacy_metric: privacyMeasure });\n      this.div.stop(true).slideDown(transitionDuration); //.fadeTo(5000, 500).slideUp(500)\n    }\n\n    /** await() puts the KgpWordedScore in a waiting state (opacity=0.5) and updates it properly once the promise has fulfilled */\n\n  }, {\n    key: \"await\",\n    value: function _await(kgpPromise, request, previousResponse) {\n      var _this = this;\n\n      kgpPromise.then(function (kgpSuccess) {\n        _this.update(kgpSuccess.result.privacy_metric);\n      }, function () {});\n    }\n  }, {\n    key: \"i18nFormat\",\n    value: function i18nFormat(text, data) {\n      //\"{#1}% de l’information génomique de la cible peut-être déduite. Son score de confidentialité est donc de {#2}%.\",\n      var score = Math.round(100 * data.privacy_metric);\n      text = text.replace(\"{#1}\", 100 - score);\n      text = text.replace(/{#2(.+?)?}/, score);\n      return text;\n    }\n  }]);\n\n  return KgpScoreNumberExplainer;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KgpScoreNumberExplainer.js?");

/***/ }),

/***/ "./app/src/js/KgpScoreRequestHandler.js":
/*!**********************************************!*\
  !*** ./app/src/js/KgpScoreRequestHandler.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.KgpScoreRequest = exports.KgpScoreRequestHandler = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _KgpScoreResponse = __webpack_require__(/*! ./KgpScoreResponse.js */ \"./app/src/js/KgpScoreResponse.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpScoreRequestHandler = exports.KgpScoreRequestHandler = function () {\n  function KgpScoreRequestHandler(api_endpoint) {\n    _classCallCheck(this, KgpScoreRequestHandler);\n\n    this.api_endpoint = api_endpoint;\n    this.lastRequest = {};\n    // necessary dummy\n    this.latestResponse = new _KgpScoreResponse.KgpScoreSuccess(-1, {}, \"\", 1.0001, 0, 0, 0);\n    this.listeners = [];\n    this.callbacks = {\n      start: [],\n      end: [],\n      error: []\n    };\n    var self = this;\n    this.addListener(function () {\n      return self.callbacksAwait.apply(self, arguments);\n    });\n  }\n\n  /** Adds a listener to requests, returns true if not already in array*/\n\n\n  _createClass(KgpScoreRequestHandler, [{\n    key: \"addListener\",\n    value: function addListener(listener) {\n      if (!this.listeners.includes(listener)) {\n        this.listeners.push(listener);\n        return true;\n      }\n      return false;\n    }\n    /** remove a listener to requests, returns removed listener */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(listener) {\n      var index = this.listeners.indexOf(listener);\n      if (index != -1) {\n        return this.listeners.splice(index, 1);\n      }\n      return [];\n    }\n  }, {\n    key: \"requestScore\",\n    value: function requestScore(target_id, familyTreeEdges, familyTreeSequencedRelatives, user_id, user_source, lng) {\n      var silent = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : false;\n\n      var self = this;\n      var currentRequest = new KgpScoreRequest(target_id, familyTreeEdges, familyTreeSequencedRelatives, user_id, user_source, lng);\n      var previousResponse = this.latestResponse;\n      this.lastRequest = currentRequest;\n\n      var kgpPromise = fetch(self.api_endpoint, {\n        method: 'POST',\n        body: JSON.stringify(currentRequest)\n      }).then(function (resp) {\n        return resp.json();\n      })\n      // handle connexion error\n      .catch(function () {\n        return Promise.reject(new _KgpScoreResponse.KgpScoreError(currentRequest.timestamp_js, currentRequest, null, 5, { \"message\": 'Erreur de connexion au serveur.' }));\n      })\n      // parse response\n      .then(function (json) {\n        var kgpr = _KgpScoreResponse.KgpScoreResponse.parse(json, currentRequest);\n        // check if it's stale or not\n        if (kgpr.timestamp_js != self.lastRequest.timestamp_js) {\n          return Promise.reject(new _KgpScoreResponse.KgpScoreStale(kgpr));\n        }\n        // if it's an error -> reject\n        if (kgpr.status == \"error\") {\n          return Promise.reject(kgpr);\n        }\n        // success!\n        self.latestResponse = kgpr;\n        return kgpr;\n      });\n\n      if (!silent) {\n        this.listeners.forEach(function (l) {\n          return l(kgpPromise, currentRequest, previousResponse);\n        });\n      }\n\n      return kgpPromise;\n    }\n\n    /** callbacks */\n\n  }, {\n    key: \"callbacksAwait\",\n    value: function callbacksAwait(kgpPromise, request, previousResponse) {\n      var self = this;\n      // for tutorial videos, comment this following line (glitches in video):\n      self.callbacks.start.forEach(function (f) {\n        return f(kgpPromise, request, previousResponse);\n      });\n      return kgpPromise.then(function (kgpSuccess) {\n        // success\n        self.callbacks.end.forEach(function (f) {\n          return f(kgpPromise, request, previousResponse);\n        });\n        //console.log(\"kgp score success: \", kgpSuccess)\n      }).catch(function (kgpError) {\n        self.callbacks.error.forEach(function (f) {\n          return f(kgpPromise, request, previousResponse);\n        });\n        //console.log(\"kgp score error: \", kgpError)\n      });\n    }\n  }]);\n\n  return KgpScoreRequestHandler;\n}();\n\n/** Creates the request that'll be sent to the Kgp server, with instant timestamp */\n\n\nvar KgpScoreRequest = exports.KgpScoreRequest = function KgpScoreRequest(target_id, familyTreeEdges, familyTreeSequencedRelatives, user_id, user_source, lng) {\n  _classCallCheck(this, KgpScoreRequest);\n\n  var timestamp_js = +new Date();\n  this.timestamp_js = timestamp_js;\n  this.family_tree = {\n    \"edges\": familyTreeEdges,\n    \"sequenced_relatives\": familyTreeSequencedRelatives,\n    \"target\": target_id\n  };\n  this.user = {\n    \"id\": user_id,\n    \"source\": user_source,\n    \"lng\": lng\n  };\n};\n\n//# sourceURL=webpack:///./app/src/js/KgpScoreRequestHandler.js?");

/***/ }),

/***/ "./app/src/js/KgpScoreResponse.js":
/*!****************************************!*\
  !*** ./app/src/js/KgpScoreResponse.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpScoreResponse = exports.KgpScoreResponse = function () {\n  function KgpScoreResponse(status, timestamp_js, request, tree_signature) {\n    var extras = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n\n    _classCallCheck(this, KgpScoreResponse);\n\n    this.status = status;\n    this.timestamp_js = timestamp_js;\n    this.request = request;\n    this.tree_signature = tree_signature;\n    this.extras = extras;\n  }\n\n  _createClass(KgpScoreResponse, null, [{\n    key: \"parseJSON\",\n    value: function parseJSON(json, request) {\n      return KgpScoreResponse.parse(JSON.parse(json), request);\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(raw, request) {\n      if (raw.status == \"OK\") {\n        return new KgpScoreSuccess(raw.timestamp_js, request, raw.tree_signature, raw.result.privacy_metric, raw.result.cached, raw.result.execution_time, raw.extras);\n      } else if (raw.status == \"error\") {\n        return new KgpScoreError(raw.timestamp_js, request, raw.tree_signature, raw.code, raw.extras);\n      } else {\n        throw new Error({ \"msg\": \"KgpScoreResponse.parse(): argument raw is not a parsable KgpScoreResponse.\", \"raw\": raw });\n      }\n    }\n  }]);\n\n  return KgpScoreResponse;\n}();\n\nvar KgpScoreSuccess = exports.KgpScoreSuccess = function (_KgpScoreResponse) {\n  _inherits(KgpScoreSuccess, _KgpScoreResponse);\n\n  function KgpScoreSuccess(timestamp_js, request, tree_signature, privacy_metric, cached, execution_time) {\n    var extras = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n\n    _classCallCheck(this, KgpScoreSuccess);\n\n    var _this = _possibleConstructorReturn(this, (KgpScoreSuccess.__proto__ || Object.getPrototypeOf(KgpScoreSuccess)).call(this, \"OK\", timestamp_js, request, tree_signature, extras));\n\n    _this.result = {\n      \"privacy_metric\": privacy_metric,\n      \"cached\": cached,\n      \"execution_time\": execution_time\n    };\n    _this.request = {}; // empty on initialisation, must be set later on\n    return _this;\n  }\n\n  return KgpScoreSuccess;\n}(KgpScoreResponse);\n\nvar KgpScoreError = exports.KgpScoreError = function (_KgpScoreResponse2) {\n  _inherits(KgpScoreError, _KgpScoreResponse2);\n\n  function KgpScoreError(timestamp_js, request, tree_signature, code) {\n    var extras = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n\n    _classCallCheck(this, KgpScoreError);\n\n    var _this2 = _possibleConstructorReturn(this, (KgpScoreError.__proto__ || Object.getPrototypeOf(KgpScoreError)).call(this, \"error\", timestamp_js, request, tree_signature, extras));\n\n    _this2.code = code;\n    return _this2;\n  }\n\n  return KgpScoreError;\n}(KgpScoreResponse);\n\nvar KgpScoreStale = exports.KgpScoreStale = function (_KgpScoreResponse3) {\n  _inherits(KgpScoreStale, _KgpScoreResponse3);\n\n  function KgpScoreStale(kgpResp) {\n    _classCallCheck(this, KgpScoreStale);\n\n    var _this3 = _possibleConstructorReturn(this, (KgpScoreStale.__proto__ || Object.getPrototypeOf(KgpScoreStale)).call(this, \"stale\", kgpResp.timestamp_js, kgpResp.request, kgpResp.tree_signature, kgpResp.extras));\n\n    _this3.staleResp = kgpResp;\n    return _this3;\n  }\n\n  return KgpScoreStale;\n}(KgpScoreResponse);\n\n//# sourceURL=webpack:///./app/src/js/KgpScoreResponse.js?");

/***/ }),

/***/ "./app/src/js/KgpSurvey.js":
/*!*********************************!*\
  !*** ./app/src/js/KgpSurvey.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.KgpSurvey = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _cookies = __webpack_require__(/*! ./lib/cookies.js */ \"./app/src/js/lib/cookies.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpSurvey = exports.KgpSurvey = function () {\n  function KgpSurvey(api_endpoint, userId, i18n) {\n    var launchWaitTimeBasis = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 60;\n    var launchWaitTimePoissonMean = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 90;\n    var launchWaitTimeMax = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 300;\n    var cookieLocalStoragePrefix = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : \"kgpmeter-\";\n\n    _classCallCheck(this, KgpSurvey);\n\n    this.api_endpoint = api_endpoint;\n    this.questions = [\"prior-knowledge\", \"score-exp\", \"you-or-family\", \"utility-website\", \"nps\", \"survey-comment\", \"survey-sex\", \"survey-age\", \"survey-own-sequence\", \"survey-other-sequence\"];\n    this.userId = userId;\n    this.i18n = i18n;\n    this.cookieName = cookieLocalStoragePrefix + \"survey-status\";\n\n    var self = this;\n\n    // Waiting time: 1m + poisson at mean 1m30\n    this.timestampFirstRequest = null;\n    this.launchWaitTimeBasis = launchWaitTimeBasis;\n    this.launchWaitTimePoissonMean = launchWaitTimePoissonMean;\n    this.launchWaitTimeMax = launchWaitTimeMax;\n    this.launchWaitTime = 10 * launchWaitTimeMax;\n    while (this.launchWaitTime > this.launchWaitTimeMax) {\n      this.launchWaitTime = this.launchWaitTimeBasis + poissonProcess.sample(this.launchWaitTimePoissonMean);\n    }\n\n    // survey launch conditions\n    this.signaturesRequestedTrees = new Set();\n    this.twoNodesAdded = false;\n    this.threeRequestsAsked = false;\n    this.oneTarget = false;\n    this.surveyNotStarted = true;\n\n    this.surveyTrigger = undefined;\n\n    // send question answer on change \n    this.questions.forEach(function (questionId) {\n      $(\"#\" + questionId + \" input\").on(\"change\", function (a, b, c) {\n        var json_to_send = {\n          question_code: questionId,\n          answer: $(this).val(),\n          survey_trigger: self.surveyTrigger,\n          user: {\n            id: self.userId,\n            lng: self.i18n.lng\n          }\n        };\n        fetch(self.api_endpoint, {\n          method: 'POST',\n          body: JSON.stringify(json_to_send)\n        });\n      });\n      // success!\n    });\n\n    // comment: different\n    $(\"#survey-comment-text\").on(\"change\", function (a, b, c) {\n      var json_to_send = {\n        question_code: \"survey-comment\",\n        answer: $(this).val(),\n        survey_trigger: self.surveyTrigger,\n        user: {\n          id: self.userId,\n          lng: self.i18n.lng\n        }\n      };\n      fetch(self.api_endpoint, {\n        method: 'POST',\n        body: JSON.stringify(json_to_send)\n      });\n    });\n\n    this.updateSurveyVolunteerButton(0);\n\n    document.getElementById(\"survey-finish-step-1-button\").addEventListener(\"click\", function () {\n      return self.changePageSurvey();\n    });\n    document.getElementById(\"survey-left-button\").addEventListener(\"click\", function () {\n      return self.surveyPrevious();\n    });\n    document.getElementById(\"survey-right-button\").addEventListener(\"click\", function () {\n      return self.closeSurvey();\n    });\n  }\n\n  /**\n   * Check that conditions to launch the survey are filled.\n   */\n\n\n  _createClass(KgpSurvey, [{\n    key: \"checkSurveyLaunchConditions\",\n    value: function checkSurveyLaunchConditions(target) {\n      var nodes = ftree.nodesArray().filter(function (n) {\n        return !n.id.match(/f|F/);\n      });\n      this.twoNodesAdded = nodes.length >= 3;\n      //let oneNodeSequenced = nodes.filter(n => n.sequencedDNA).length >= 1\n      this.threeRequestsAsked = this.signaturesRequestedTrees.size >= 3;\n      this.oneTarget = Boolean(target);\n      this.surveyNotStarted = !this.getSurveyStatus();\n      //console.log(\"twoNodesAdded=\",twoNodesAdded,\", threeRequestsAsked=\",threeRequestsAsked,\", oneTarget=\",oneTarget,\", !surveyStarted\", !surveyStarted)\n\n      return this.twoNodesAdded && this.threeRequestsAsked && this.oneTarget && this.surveyNotStarted;\n    }\n\n    /**\n     * launch the survey\n     * @param {*} trigger either \"volunteer\", \"automatic\", \"resume\"\n     */\n\n  }, {\n    key: \"launchSurvey\",\n    value: function launchSurvey(trigger) {\n      var status = this.getSurveyStatus();\n      if (status != \"finished\") {\n        this.surveyTrigger = trigger;\n        this.setSurveyStatus(\"launched\");\n        $(\"#modal-survey\").modal('show');\n      }\n      //$('#modal-survey').on('hidden.bs.modal', function (e) {if(getSurveyStatus()!=\"finished\"){ showSurveyVolunteerButton() }})\n    }\n  }, {\n    key: \"await\",\n    value: function _await(kgpPromise, request, previousResponse) {\n      var _this = this;\n\n      var self = this;\n      kgpPromise.then(function (kgpSuccess) {\n        _this.signaturesRequestedTrees.add(kgpSuccess.tree_signature);\n        // if needed, set timestamp of first request\n        if (!_this.timestampFirstRequest) {\n          _this.timestampFirstRequest = kgpSuccess.timestamp_js;\n        }\n        // if launch conditions filled: launch survey (after required timeout)\n        if (_this.checkSurveyLaunchConditions(request.family_tree.target)) {\n          var now = +new Date();\n          var timeSinceFirstRequest = now - _this.timestampFirstRequest;\n          var timeout = void 0;\n          if (timeSinceFirstRequest > 1000 * _this.launchWaitTime) {\n            // if the launchWaitTime is elapsed: launch after 5 seconds\n            timeout = 5000;\n          } else {\n            // if the launchWaitTime isn't elapsed yet: launch after the time delta\n            timeout = 1000 * _this.launchWaitTime - timeSinceFirstRequest;\n          }\n          setTimeout(function () {\n            return self.launchSurvey(\"automatic\");\n          }, timeout);\n        }\n      }).catch(function () {});\n    }\n  }, {\n    key: \"updateSurveyVolunteerButton\",\n    value: function updateSurveyVolunteerButton() {\n      var transitionSpeed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 500;\n\n      var self = this;\n      //\n      var surveyStatus = this.getSurveyStatus();\n      $(\"#survey-launch-button\").off(\"click\");\n      // not launched: volunteer\n      if (!surveyStatus) {\n        $(\"#survey-launch-button span\").attr(self.i18n.keyAttr, \"survey-volunteer\");\n        $(\"#survey-launch-button\").stop(true).slideDown(transitionSpeed);\n        $(\"#survey-launch-button\").on(\"click\", function () {\n          return self.launchSurvey(\"volunteer\");\n        });\n        // launched: resume\n      } else if (surveyStatus == \"launched\" || surveyStatus == \"step-1-done\") {\n        $(\"#survey-launch-button span\").attr(self.i18n.keyAttr, \"survey-resume\");\n        $(\"#survey-launch-button\").stop(true).slideDown(transitionSpeed);\n        $(\"#survey-launch-button\").on(\"click\", function () {\n          return self.launchSurvey(\"resume\");\n        });\n        // finished: hide\n      } else if (surveyStatus == \"finished\") {\n        $(\"#survey-launch-button\").stop(true).slideUp(transitionSpeed);\n      }\n    }\n    /** from step 1 to step 2 */\n\n  }, {\n    key: \"changePageSurvey\",\n    value: function changePageSurvey() {\n      $(\"#survey-finish-step-1-button\").hide();\n      $(\"#survey-finish-step-2-button\").show();\n      $(\"#survey-step-1\").hide();\n      $(\"#survey-step-2\").show();\n      this.setSurveyStatus(\"step-1-done\");\n    }\n\n    /** back to step 1 from step 2 */\n\n  }, {\n    key: \"surveyPrevious\",\n    value: function surveyPrevious() {\n      $(\"#survey-step-2\").hide();\n      $(\"#survey-finish-step-2-button\").hide();\n      $(\"#survey-step-1\").show();\n      $(\"#survey-finish-step-1-button\").show();\n      this.setSurveyStatus(\"launched\");\n    }\n\n    /** finish at step 2 */\n\n  }, {\n    key: \"closeSurvey\",\n    value: function closeSurvey() {\n      $(\"#modal-survey\").modal('hide');\n      $(\"#survey-step-2\").hide();\n      $(\"#survey-finish-step-2-button\").hide();\n      $(\"#survey-step-1\").show();\n      $(\"#survey-finish-step-1-button\").show();\n      this.setSurveyStatus(\"finished\");\n    }\n\n    /**\n     * getSurveyStatus(): reads the survey-status cookie...\n     * \n     * @returns undefined if not launched,\n     *          \"launched\" if launched and step 1 not done,\n     *          \"step-1-done\" if step 1 is done, but not step 2 (=user clicked on first finish button)\n     *          \"finished\" if finished (=user clicked on second finish button)\n     */\n\n  }, {\n    key: \"getSurveyStatus\",\n    value: function getSurveyStatus() {\n      return _cookies.cookie.read(this.cookieName);\n    }\n  }, {\n    key: \"setSurveyStatus\",\n    value: function setSurveyStatus(status) {\n      _cookies.cookie.create(this.cookieName, status, 1);\n      this.updateSurveyVolunteerButton();\n    }\n  }]);\n\n  return KgpSurvey;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KgpSurvey.js?");

/***/ }),

/***/ "./app/src/js/KgpTutorial.js":
/*!***********************************!*\
  !*** ./app/src/js/KgpTutorial.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.kgpTutorial = kgpTutorial;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpTutorialButton = exports.KgpTutorialButton = function () {\n  function KgpTutorialButton(domId, kgp) {\n    var listeners = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    _classCallCheck(this, KgpTutorialButton);\n\n    this.domId = domId;\n    this.kgp = kgp;\n    this.listeners = listeners;\n    this.init();\n  }\n\n  _createClass(KgpTutorialButton, [{\n    key: \"init\",\n    value: function init() {\n      d3.select(\"#\" + this.domId).remove();\n      // trash button\n      this.tutoButton = this.kgp.addSvgButton(\"\\uF059\", this.domId, \"hint-tuto\", 0, 57, 22, 0, 60);\n      this.tutoButton.attr(\"data-toggle\", 'modal').attr(\"data-target\", '#tuto-modal');\n      var self = this;\n      Object.keys(this.listeners).forEach(function (k) {\n        return self.tutoButton.on(k, self.listeners[k]);\n      });\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, listener) {\n      this.listeners[event] = listener;\n      this.tutoButton.on(event, listener);\n    }\n  }]);\n\n  return KgpTutorialButton;\n}();\n\nfunction kgpTutorial(i18n) {\n  //intro1: 'Construisez votre arbre de famille: <img class=\"tutorial-img\" src=\"../img/tool/tuto1_build.png\">'\n  //intro2: 'Indiquez qui est séquencé dans votre famille: <img class=\"tutorial-img\" src=\"../img/tool/tuto2_sequence.png\">'\n  //intro3: 'Observez votre score: <video controls=\"false\" autoplay width=\"365px\" height=\"348px\" name=\"Video Name\" src=\"../img/tool/tuto3_score.mov\"></video>'+'<script type=\"javascript\">var vids = $(\"video\");$.each(vids, function(){this.controls = false;});</script>'\n\n  var tutoStep = 0;\n  var nbTutoSteps = 4;\n  var prevKey = \"previous-button\";\n  var nextKey = \"next-button\";\n  var closeKey = \"close-button\";\n\n  var leftButton = document.getElementById(\"tuto-left-button\");\n  leftButton.setAttribute(i18n.keyAttr, prevKey);\n  leftButton.addEventListener(\"click\", previousTutoStep);\n  var rightButton = document.getElementById(\"tuto-right-button\");\n  // puce events\n\n  var _loop = function _loop(i) {\n    d3.select(\"#tuto-puce\" + i).on(\"click\", function (d) {\n      tutoStep = i;\n      loadTutoStep();\n    });\n  };\n\n  for (var i in d3.range(nbTutoSteps)) {\n    _loop(i);\n  }\n\n  function previousTutoStep() {\n    tutoStep--;\n    loadTutoStep();\n  }\n  function nextTutoStep() {\n    tutoStep++;\n    loadTutoStep();\n  }\n  function hideModal() {\n    $('#tuto-modal').modal('hide');\n    cloneReplaceElement(rightButton);\n    cloneReplaceElement(leftButton);\n  }\n  function cloneReplaceElement(el) {\n    var elClone = el.cloneNode(true);\n    el.parentNode.replaceChild(elClone, el);\n    return elClone;\n  }\n\n  function loadTutoStep() {\n    $(\"#tuto-title\").attr(i18n.keyAttr, \"tuto-title-\" + tutoStep);\n    $(\"#tuto-text\").attr(i18n.keyAttr, \"tuto-text-\" + tutoStep);\n    var video_lng = i18n.lng == \"fr\" ? i18n.lng : \"en\"; // video only in french or english\n    $(\"#tuto-video\").attr(\"src\", \"./tuto/tuto_\" + video_lng + \"_\" + tutoStep + \".mp4\");\n    $(\"#tuto-video\").currentTime = 0;\n    d3.selectAll(\".tuto-puce\").transition(500).attr(\"fill\", \"#f0f0f0\");\n    d3.select(\"#tuto-puce\" + tutoStep).transition(500).attr(\"fill\", \"grey\");\n\n    // left-hand button\n    if (tutoStep == 0) {\n      leftButton.classList.add(\"disabled\");\n    } else {\n      leftButton.classList.remove(\"disabled\");\n    }\n\n    // right-hand button\n    if (tutoStep >= nbTutoSteps - 1) {\n      rightButton = cloneReplaceElement(rightButton);\n      rightButton.setAttribute(i18n.keyAttr, closeKey);\n      rightButton.addEventListener(\"click\", hideModal);\n    } else {\n      rightButton = cloneReplaceElement(rightButton);\n      rightButton.setAttribute(i18n.keyAttr, nextKey);\n      rightButton.addEventListener(\"click\", nextTutoStep);\n    }\n  }\n\n  loadTutoStep();\n\n  // text formatters: add buttons svgs in text \n  function tuto0formatter(text, data) {\n    text = text.replace(\"{#add}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-6px' y='5px' style='font-size:12px'>&#xf234;</text></g></svg>\");\n    text = text.replace(\"{#remove}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-7px' y='5px' style='font-size:12px'>&#xf506;</text></g></svg>\");\n    return text;\n  }\n  i18n.dynamic[\"tuto-text-0\"] = tuto0formatter;\n\n  function tuto1formatter(text, data) {\n    text = text.replace(\"{#sequence}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-7px' y='5px' style='font-size:12px'>&#xf471;+</text></g></svg>\");\n    text = text.replace(\"{#unsequence}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-7px' y='5px' style='font-size:12px'>&#xf471;-</text></g></svg>\");\n    return text;\n  }\n  i18n.dynamic[\"tuto-text-1\"] = tuto1formatter;\n\n  function tuto2formatter(text, data) {\n    text = text.replace(\"{#target}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-6px' y='5px' style='font-size:12px'>&#xf05b;</text></g></svg>\");\n    return text;\n  }\n  i18n.dynamic[\"tuto-text-2\"] = tuto2formatter;\n\n  function tuto3formatter(text, data) {\n    text = text.replace(\"{#sex}\", \"<svg style='position:relative;top:6px;' height='24px' width='24px'><g transform='translate(12,12)'><circle r='12' class='node-button-circle'></circle><text class='fas node-button-fas' x='-6px' y='5px' style='font-size:12px'>&#xf228;</text></g></svg>\");\n    return text;\n  }\n  i18n.dynamic[\"tuto-text-3\"] = tuto3formatter;\n}\n\n//# sourceURL=webpack:///./app/src/js/KgpTutorial.js?");

/***/ }),

/***/ "./app/src/js/KgpWordedScore.js":
/*!**************************************!*\
  !*** ./app/src/js/KgpWordedScore.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KgpWordedScore = exports.KgpWordedScore = function () {\n  function KgpWordedScore(parentId, id, elementClass, x, y, height, colorScale, i18n, i18nKey) {\n    _classCallCheck(this, KgpWordedScore);\n\n    this.parentId = parentId;\n    this.id = id;\n    this.elementClass = elementClass;\n    this.x = x;\n    this.y = y;\n    this.height = height;\n    this.colorScale = colorScale;\n    this.i18n = i18n;\n    this.i18nKey = i18nKey;\n    this.privacyStatus = 1;\n\n    this.init();\n  }\n\n  _createClass(KgpWordedScore, [{\n    key: \"init\",\n    value: function init() {\n      var self = this;\n\n      d3.select(\"#\" + this.id).remove();\n\n      this.text = d3.select(\"#\" + this.parentId).append(\"text\").attr(\"x\", this.x).attr(\"y\", this.y).attr(\"height\", this.height).attr(\"text-anchor\", \"end\").attr(\"fill\", \"darkgrey\").attr(\"id\", this.id).attr(\"class\", this.elementClass)\n      //TODO: fix i18n.keyAttr reference\n      .attr(this.i18n.keyAttr, self.i18nKey);\n      this.scale = d3.scaleLinear().range([self.height, 0]).domain([0, 1]);\n\n      this.i18n.dynamic[self.i18nKey] = function (t, d) {\n        return self.i18nFormat(t, d);\n      };\n      this.hide(0);\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      var transitionDuration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 3000;\n\n      this.text.transition(transitionDuration).attr(\"opacity\", 0);\n    }\n\n    /** update() updates the KgpWordedScore with a new score */\n\n  }, {\n    key: \"update\",\n    value: function update(privacyMeasure) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 3000;\n\n      var self = this;\n      //TODO: use a proper instance nbBoxes...\n      if (privacyMeasure > 0.99) {\n        this.privacyStatus = 100;\n      } else if (privacyMeasure >= 0.8) {\n        this.privacyStatus = 5;\n      } else if (privacyMeasure >= 0.6) {\n        this.privacyStatus = 4;\n      } else if (privacyMeasure >= 0.4) {\n        this.privacyStatus = 3;\n      } else if (privacyMeasure >= 0.2) {\n        this.privacyStatus = 2;\n      } else {\n        this.privacyStatus = 1;\n      }\n      //if(kgp.target){\n      this.text.attr(\"opacity\", 0.2).transition(transitionDuration).attr(\"opacity\", 1);\n      this.i18n.data(this.i18nKey, this.privacyStatus);\n      setTimeout(function () {\n        return d3.select(\"#\" + self.id + \" tspan\").attr(\"fill\", self.colorScale(privacyMeasure));\n      }, 50);\n      /*} else{\n        this.hide()\n      }*/\n    }\n\n    /** await() puts the KgpWordedScore in a waiting state (opacity=0.5) and updates it properly once the promise has fulfilled */\n\n  }, {\n    key: \"await\",\n    value: function _await(kgpPromise, request, previousResponse) {\n      var _this = this;\n\n      if (this.text.attr(\"opacity\") == 1) {\n        this.text.transition(200).attr(\"opacity\", 0.5);\n      }\n\n      kgpPromise.then(function (kgpSuccess) {\n        _this.update(kgpSuccess.result.privacy_metric);\n      }, function () {});\n    }\n  }, {\n    key: \"i18nFormat\",\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(text, data) {\n        var qualifier;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.i18n.t(\"privacy-bar-score-\" + data);\n\n              case 2:\n                qualifier = _context.sent;\n                return _context.abrupt(\"return\", text.replace(\"{}\", qualifier ? qualifier : \"...\"));\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function i18nFormat(_x3, _x4) {\n        return _ref.apply(this, arguments);\n      }\n\n      return i18nFormat;\n    }()\n  }]);\n\n  return KgpWordedScore;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KgpWordedScore.js?");

/***/ }),

/***/ "./app/src/js/KinGenomicPrivacyMeter.js":
/*!**********************************************!*\
  !*** ./app/src/js/KinGenomicPrivacyMeter.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.KinGenomicPrivacyMeter = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _cookies = __webpack_require__(/*! ./lib/cookies.js */ \"./app/src/js/lib/cookies.js\");\n\nvar _FamilyTreeLayout = __webpack_require__(/*! ./FamilyTreeLayout.js */ \"./app/src/js/FamilyTreeLayout.js\");\n\nvar _FamilyTreeArtist = __webpack_require__(/*! ./FamilyTreeArtist.js */ \"./app/src/js/FamilyTreeArtist.js\");\n\nvar _KgpScoreRequestHandler = __webpack_require__(/*! ./KgpScoreRequestHandler.js */ \"./app/src/js/KgpScoreRequestHandler.js\");\n\nvar _KgpSurvey = __webpack_require__(/*! ./KgpSurvey.js */ \"./app/src/js/KgpSurvey.js\");\n\nvar _KgpBackendStatus = __webpack_require__(/*! ./KgpBackendStatus.js */ \"./app/src/js/KgpBackendStatus.js\");\n\nvar _KgpScoreNumberExplainer = __webpack_require__(/*! ./KgpScoreNumberExplainer.js */ \"./app/src/js/KgpScoreNumberExplainer.js\");\n\nvar _KgpWordedScore = __webpack_require__(/*! ./KgpWordedScore.js */ \"./app/src/js/KgpWordedScore.js\");\n\nvar _KgpPrivacyBar = __webpack_require__(/*! ./KgpPrivacyBar.js */ \"./app/src/js/KgpPrivacyBar.js\");\n\nvar _KgpIframeInterface = __webpack_require__(/*! ./KgpIframeInterface */ \"./app/src/js/KgpIframeInterface.js\");\n\nvar _TrashButton = __webpack_require__(/*! ./TrashButton.js */ \"./app/src/js/TrashButton.js\");\n\nvar _KgpTutorial = __webpack_require__(/*! ./KgpTutorial.js */ \"./app/src/js/KgpTutorial.js\");\n\nvar _utils = __webpack_require__(/*! ./utils.js */ \"./app/src/js/utils.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar KinGenomicPrivacyMeter = exports.KinGenomicPrivacyMeter = function () {\n  function KinGenomicPrivacyMeter(api_base_url, svgId, youNodeId, i18n) {\n    var cookieLocalStoragePrefix = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"kgpmeter-\";\n    var options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n    _classCallCheck(this, KinGenomicPrivacyMeter);\n\n    this.setOptions(options);\n    var self = this;\n    this.i18n = i18n;\n\n    this.svg = d3.select(\"#\" + svgId);\n    this.svgHeight = parseInt(this.svg.attr(\"height\"));\n    this.svgOriginalHeight = this.svgHeight;\n    this.updateSvgHeight(this.svgHeight, 800, true);\n\n    this.youNodeId = youNodeId; // \"@I1@\"\n    this.privacyMetric = 1;\n    this.relationships = KinGenomicPrivacyMeter.getRelationships();\n\n    this.indiNodeSize = { width: 100, height: 100 };\n    this.famNodeSize = { width: 7, height: 7 };\n\n    this.updateSvgWidth();\n\n    // set language event\n    function setLanguage(e) {\n      i18n.changeLanguage(e.detail.lng);\n    }\n    window.document.addEventListener('KgpSetLanguageEvent', setLanguage, false);\n\n    // set max dimensions event\n    function setIframeMaxDimensionEvent(e) {\n      self.options.svgMaxHeight = e.detail.maxHeight;\n    }\n    window.document.addEventListener('KgpSetIframeMaxDimensionEvent', setIframeMaxDimensionEvent, false);\n\n    // user id&source + source event\n    var idCookie = cookieLocalStoragePrefix + \"user-id\";\n    var sourceCookie = cookieLocalStoragePrefix + \"user-source\";\n    this.userId = _cookies.cookie.read(idCookie);\n    this.userSource = _cookies.cookie.read(sourceCookie);\n    if (!this.userId) {\n      this.userId = +new Date() + \"-\" + Math.random();\n      _cookies.cookie.create(idCookie, this.userId, 1);\n    }\n    function setSource(e) {\n      var userSource = _cookies.cookie.read(sourceCookie);\n      if (!userSource) {\n        // if no source: init user source\n        self.userSource = e.detail.source ? e.detail.source : document.URL;\n        // TODO: remove or refine ?test\n        if (Boolean(self.userSource.match(/\\/privacy-dev\\//))) {\n          self.userSource = self.userSource + \"?test\";\n        }\n        _cookies.cookie.create(sourceCookie, self.userSource, 1);\n\n        // send init request\n        self.scoreRequestHandler.requestScore(\"i1\", [[\"i1\", \"f1\"], [\"f1\", \"i2\"]], [], self.userId, self.userSource, self.i18n.lng, true // silent request\n        );\n      }\n    }\n    window.document.addEventListener('KgpSetSourceEvent', setSource, false);\n    // if app not enclosed in an iframe: set source as current URL after 1sec\n    setTimeout(function createUserAfterTimeout() {\n      var setSourceEvent = (0, _KgpIframeInterface.kgpSetSourceEvent)(document.URL);\n      document.dispatchEvent(setSourceEvent);\n    }, 1000);\n\n    // api urls\n    this.setApiUrl(api_base_url);\n\n    this.kgpsurvey = new _KgpSurvey.KgpSurvey(this.surveyApiEndpoint, this.userId, this.i18n);\n\n    // privacy bar\n    var privacyBarWidth = 30;\n    var privacyBarStrokeWidth = 4;\n    this.privacyBar = new _KgpPrivacyBar.KgpPrivacyBar(this.svg.attr(\"id\"), \"privacy-bar-g\", this.svgWidth - privacyBarWidth - privacyBarStrokeWidth, 30, 30, 400, 5, d3.interpolateRgbBasis([\"rgb(255,0,0)\", \"rgb(255,125,0)\", \"rgb(255,255,0)\", \"rgb(0,195,0)\"]), self.i18n);\n\n    // privacy worded score\n    this.privacyWordedScore = new _KgpWordedScore.KgpWordedScore(this.privacyBar.g.attr(\"id\"), \"privacy-bar-title\", \"privacy-bar-element\", this.privacyBar.width, -16, 20, this.privacyBar.colorScale, self.i18n, \"privacy-bar-title\");\n\n    // backend status\n    this.backendStatus = new _KgpBackendStatus.KgpBackendStatus(\"kgp-response-container\", self.i18n);\n\n    // explainer\n    this.scoreNumberExplainer = new _KgpScoreNumberExplainer.KgpScoreNumberExplainer(\"kgp-explainer-container\", self.i18n, \"explainer-text\");\n\n    // request handler\n    this.scoreRequestHandler = new _KgpScoreRequestHandler.KgpScoreRequestHandler(this.privacyScoreApiEndpoint);\n    // update privacyMetric\n    this.scoreRequestHandler.addListener(function (kgpPromise) {\n      kgpPromise.then(function (kgpSuccess) {\n        return self.privacyMetric = kgpSuccess.result.privacy_metric;\n      }, function () {});\n    });\n    // update cursor\n    this.scoreRequestHandler.addListener(function (kgpPromise) {\n      $(\"body\").css({ 'cursor': 'progress' });\n      kgpPromise.then(function (kgpSuccess) {\n        return $(\"body\").css({ 'cursor': 'auto' });\n      }, function (kgpError) {\n        return $(\"body\").css({ 'cursor': 'auto' });\n      });\n    });\n    // ...other listeners\n    this.scoreRequestHandler.addListener(function () {\n      var _self$privacyBar;\n\n      return (_self$privacyBar = self.privacyBar).await.apply(_self$privacyBar, arguments);\n    });\n    this.scoreRequestHandler.addListener(function () {\n      var _self$privacyWordedSc;\n\n      return (_self$privacyWordedSc = self.privacyWordedScore).await.apply(_self$privacyWordedSc, arguments);\n    });\n    this.scoreRequestHandler.addListener(function () {\n      var _self$backendStatus;\n\n      return (_self$backendStatus = self.backendStatus).await.apply(_self$backendStatus, arguments);\n    });\n    this.scoreRequestHandler.addListener(function () {\n      var _self$scoreNumberExpl;\n\n      return (_self$scoreNumberExpl = self.scoreNumberExplainer).await.apply(_self$scoreNumberExpl, arguments);\n    });\n    this.scoreRequestHandler.addListener(function () {\n      var _self$kgpsurvey;\n\n      return (_self$kgpsurvey = self.kgpsurvey).await.apply(_self$kgpsurvey, arguments);\n    });\n\n    // trash button\n    this.trashButton = new _TrashButton.TrashButton(\"trash-button\", this, { \"click.trash\": function clickTrash(d) {\n        return self.reset();\n      } });\n    this.tutorialButton = new _KgpTutorial.KgpTutorialButton(\"tutorial-button\", this, { \"click.tutorial\": function clickTutorial(d) {\n        return (0, _KgpTutorial.kgpTutorial)(self.i18n);\n      } });\n\n    // launch tutorial event\n    window.document.addEventListener('KgpLaunchTutorialEvent', function () {\n      $(\"#tuto-modal\").modal(\"show\");\n      (0, _KgpTutorial.kgpTutorial)(self.i18n);\n    }, false);\n\n    (0, _utils.onWindowResize)(function () {\n      return self.resizeSvg();\n    });\n    (0, _utils.onWindowResize)(function () {\n      return d3.range(1000);\n    }); // hack with an astonishing effect: fixes problems with privacyBar&target on window resize...\n\n    this.ftree = this.loadFamilyTreeFromLocalStorage();\n    var savedFtree = Boolean(this.ftree);\n    if (!savedFtree) {\n      this.ftree = KinGenomicPrivacyMeter.getEmptyFamilyTree();\n    }\n\n    this.familyTreeArtist = new _FamilyTreeArtist.FamilyTreeArtist(this, this.i18n, this.target, 0);\n\n    if (this.target) {\n      var waitTime = 200;\n      setTimeout(function () {\n        return self.selectTarget(self.target, true);\n      }, waitTime);\n    }\n    if (savedFtree) {\n      this.scoreRequestHandler.requestScore(self.target ? self.target.id : \"\", this.ftree.getLinksAsIds(), this.ftree.nodesArray().filter(function (n) {\n        return n.sequencedDNA;\n      }).map(function (n) {\n        return n.id;\n      }), self.userId, self.userSource, this.i18n.lng);\n    }\n    this.mobileBlock();\n    this.IEBlock();\n  }\n\n  /** Resets the family tree in a pleasant way */\n\n\n  _createClass(KinGenomicPrivacyMeter, [{\n    key: \"reset\",\n    value: function reset() {\n      var transitionDuration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 800;\n\n\n      var self = this;\n      // delete all nodes except you\n      this.ftree.nodesArray().forEach(function (n) {\n        if (n.id != self.youNodeId) {\n          self.ftree.deleteNode(n.id, self.youNodeId);\n        }\n      });\n      this.familyTreeArtist.nodeButtons.hide();\n      // set privacy score back to 1:\n      self.privacyMetric = 1;\n      self.target = null;\n      this.privacyBar.elements.transition(200).attr(\"opacity\", 1);\n      this.privacyBar.update(1);\n      this.backendStatus.hide();\n      this.privacyWordedScore.hide();\n      this.scoreNumberExplainer.hide();\n\n      // smoothly transition back to original position\n      this.familyTreeArtist.update(false, transitionDuration);\n\n      // once this is done (after 800ms), reset to the empty ftree\n      setTimeout(function () {\n        self.ftree = KinGenomicPrivacyMeter.getEmptyFamilyTree();\n        d3.select(\"#familytree-g\").remove();\n        self.familyTreeArtist.init(0);\n        self.saveFamilyTreeToLocalStorage();\n      }, transitionDuration + 2);\n    }\n  }, {\n    key: \"resetOptions\",\n    value: function resetOptions() {\n      this.options = {\n        svgMaxHeight: 2000,\n        maxFamilyTreeDepth: 5\n      };\n    }\n  }, {\n    key: \"setOptions\",\n    value: function setOptions(options) {\n      this.resetOptions();\n      this.addOptions(options);\n    }\n  }, {\n    key: \"addOptions\",\n    value: function addOptions(options) {\n      Object.assign(this.options, options);\n    }\n  }, {\n    key: \"saveFamilyTreeToLocalStorage\",\n    value: function saveFamilyTreeToLocalStorage() {\n      var familyTreeKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"kgp-familyTree\";\n      var targetKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"kgp-targetId\";\n      var saveDateKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"kgp-saveDate\";\n\n      localStorage.setItem(familyTreeKey, JSON.stringify(this.ftree.serialize([\"sequencedDNA\", \"lastSequencedDNA\", \"i18nName\"])));\n      localStorage.setItem(saveDateKey, +new Date());\n      if (this.target) {\n        localStorage.setItem(targetKey, this.target.id);\n      } else {\n        localStorage.setItem(targetKey, null);\n      }\n    }\n  }, {\n    key: \"loadFamilyTreeFromLocalStorage\",\n    value: function loadFamilyTreeFromLocalStorage() {\n      var familyTreeKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"kgp-familyTree\";\n      var targetKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"kgp-targetId\";\n      var saveDateKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"kgp-saveDate\";\n      var familyTreeClass = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : _FamilyTreeLayout.FamilyTreeLayout;\n\n      var familyTree = null;\n      var ftl = localStorage.getItem(familyTreeKey);\n      var targetId = localStorage.getItem(targetKey);\n      var saveDate = +localStorage.getItem(saveDateKey);\n      if (Boolean(ftl) & saveDate + 2 * 3600 * 1000 >= +new Date()) {\n        familyTree = familyTreeClass.unserialize(ftl);\n        this.target = targetId ? familyTree.nodes[targetId] : null;\n      }\n      return familyTree;\n    }\n  }, {\n    key: \"selectTarget\",\n    value: function selectTarget(newTarget) {\n      var forceUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var self = this;\n      if (!newTarget.id) {\n        newTarget = this.ftree.nodesArray().filter(function (n) {\n          return n.id == newTarget;\n        })[0];\n      }\n      if (forceUpdate || !this.target || newTarget.id != this.target.id) {\n        var oldTarget = self.target;\n        this.target = newTarget;\n        this.familyTreeArtist.setAsTarget(newTarget, oldTarget);\n        this.scoreRequestHandler.requestScore(self.target ? self.target.id : \"\", this.ftree.getLinksAsIds(), this.ftree.nodesArray().filter(function (n) {\n          return n.sequencedDNA;\n        }).map(function (n) {\n          return n.id;\n        }), self.userId, self.userSource, self.i18n.lng);\n        self.saveFamilyTreeToLocalStorage();\n      }\n    }\n  }, {\n    key: \"setApiUrl\",\n    value: function setApiUrl(api_base_url) {\n      this.api_base_url = api_base_url;\n      var separator = this.api_base_url.endsWith(\"/\") ? \"\" : \"/\";\n      this.privacyScoreApiEndpoint = this.api_base_url + separator + \"privacy-score\";\n      this.surveyApiEndpoint = this.api_base_url + separator + \"survey\";\n    }\n  }, {\n    key: \"updateSvgHeight\",\n    value: function updateSvgHeight(heightFtree) {\n      var transitionsDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 800;\n      var forceEnclosingHeightUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var newSvgHeight = this.svgHeight;\n      if (heightFtree < this.svgOriginalHeight) {\n        //tree height smaller than minimum\n        newSvgHeight = this.svgOriginalHeight;\n      }\n      // tree height between minimum and max\n      if (heightFtree >= this.svgOriginalHeight && heightFtree <= this.options.svgMaxHeight) {\n        newSvgHeight = heightFtree;\n      }\n      // tree height taller than maximum\n      if (heightFtree > this.options.svgMaxHeight) {\n        newSvgHeight = this.options.svgMaxHeight;\n      }\n      // if needed -> change it\n      if (newSvgHeight != this.svgHeight || forceEnclosingHeightUpdate) {\n        var oldBodyHeight = document.getElementsByTagName('body')[0].scrollHeight;\n        var newBodyHeight = oldBodyHeight - this.svgHeight + newSvgHeight;\n        this.svgHeight = newSvgHeight;\n        this.svg.transition().duration(transitionsDuration).attr(\"height\", newSvgHeight);\n        var event = (0, _KgpIframeInterface.kgpSetHeightEvent)(newBodyHeight + 20, transitionsDuration);\n        window.parent.document.dispatchEvent(event);\n      }\n    }\n\n    /** Update the svg width, called on window resizes */\n\n  }, {\n    key: \"updateSvgWidth\",\n    value: function updateSvgWidth() {\n      this.svgWidth = this.svg.node().parentNode.clientWidth;\n      this.svg.attr(\"width\", this.svgWidth);\n    }\n\n    /**\n    * function correctly resizing svg, family tree and privacy bar according to svg's parent node\n    */\n\n  }, {\n    key: \"resizeSvg\",\n    value: function resizeSvg() {\n      var self = this;\n      // remove all children of svg\n      var svgNode = this.svg.node();\n      while (svgNode.firstChild) {\n        svgNode.removeChild(svgNode.firstChild);\n      }\n      // resize svg\n      this.updateSvgWidth();\n      // redraw tree&privacy bar\n      this.privacyBar.init(self.svgWidth - this.privacyBar.width - this.privacyBar.strokeWidth, this.privacyBar.y, 0);\n      this.privacyWordedScore.init();\n      this.privacyWordedScore.hide();\n      this.trashButton.init();\n      this.tutorialButton.init();\n\n      if (self.target) {\n        self.privacyBar.update(self.privacyMetric, 0);\n        self.privacyWordedScore.update(self.privacyMetric, 0);\n      }\n      this.familyTreeArtist.init(0);\n      this.mobileBlock();\n      this.IEBlock();\n    }\n\n    /** Returns the family relation to center node (\"you\") of target relation\n     * \n     * for rexample relationToYou(\"father\", \"son\") will return \"brother\" (the \"son\" of your \"father\" is your \"brother\")\n    */\n\n  }, {\n    key: \"relationToYou\",\n    value: function relationToYou(sourceRelation, targetRelation) {\n      if (this.relationships[sourceRelation] && this.relationships[sourceRelation][targetRelation]) {\n        return this.relationships[sourceRelation][targetRelation];\n      }\n\n      var sex = KinGenomicPrivacyMeter.getSex(targetRelation, sourceRelation);\n      if (sex == \"F\") {\n        return \"woman\";\n      }\n      if (sex == \"M\") {\n        return \"man\";\n      }\n      return undefined;\n    }\n\n    /** use by TrashButton, TrashButtonWithConfirmation */\n\n  }, {\n    key: \"addSvgButton\",\n    value: function addSvgButton(FAunicode, gId, i18nKey) {\n      var x = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var y = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      var tooltipX = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 22;\n      var tooltipY = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var tooltipWidth = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 80;\n      var tooltipHeight = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 50;\n\n      var button = this.svg.append(\"g\").attr(\"id\", gId).attr(\"transform\", \"translate(\" + x + \",\" + y + \")\").attr(\"style\", \"cursor:pointer;\").classed(\"button-with-tooltip\", true);\n      button.append(\"rect\").classed(\"svg-button\", true).attr(\"width\", 60) // big width to allow button to reduce tooltip hide sensitivity\n      .attr(\"height\", 25).attr(\"fill\", \"white\").attr(\"opacity\", 0);\n\n      button.append(\"text\").attr(\"class\", \"fas svg-button-fas\").attr(\"y\", 20).text(FAunicode);\n      button.append(\"foreignObject\").attr(\"x\", tooltipX).attr(\"y\", tooltipY).attr(\"width\", tooltipWidth).attr(\"height\", tooltipHeight).classed(\"tooltip\", true).append(\"xhtml:div\").append(\"span\").classed(\"tooltip-text\", true).attr(this.i18n.keyAttr, i18nKey);\n\n      return button;\n    }\n\n    /** block IE if detected, not the same as mobile as foreignObject not supported */\n\n  }, {\n    key: \"IEBlock\",\n    value: function IEBlock() {\n      var self = this;\n      if ((0, _utils.detectIE11)()) {\n        self.svg.append(\"rect\").attr(\"width\", self.svgWidth).attr(\"height\", self.svgHeight).attr(\"fill\", \"white\").attr(\"opacity\", \"0.8\");\n\n        this.backendStatus.displayDanger(\"IE-block-error\", 10000000000);\n      }\n    }\n\n    /** Block mobile browsers when detected, not the same as IE as foreignObject allows text to wrap in multiple lines on small screens. */\n\n  }, {\n    key: \"mobileBlock\",\n    value: function mobileBlock() {\n      var self = this;\n      if ((0, _utils.detectMobile)()) {\n        self.svg.append(\"rect\").attr(\"width\", self.svgWidth).attr(\"height\", self.svgHeight).attr(\"fill\", \"white\").attr(\"opacity\", \"0.8\");\n\n        self.svg.append(\"foreignObject\").attr(\"y\", self.svgHeight / 4).attr(\"width\", self.svgWidth).attr(\"height\", self.svgHeight).append(\"xhtml:div\").attr(\"style\", \"max:width:100%;\").attr(\"data-i18n\", \"mobile-block\");\n\n        this.backendStatus.displayDanger(\"mobile-block\", 10000000000);\n      }\n    }\n\n    /** Debugging: show node ids on hover */\n\n  }, {\n    key: \"showNodesIds\",\n    value: function showNodesIds() {\n      self.svgg.selectAll(\".nodeg\").append('text').text(function (d) {\n        return d.id;\n      })\n      //.attr(\"class\",\"node-id\")\n      .attr(\"transform\", \"translate(\" + -50 + \",0)\");\n    }\n\n    /** Creates a depth 2 dictionary to encode relationships in a family\n     * \n     * index1 represents \"source relation\" and index2 \"target relation\"\n     * It is not complete, hence relationToYou(source, target) should be used to find a relation*/\n\n  }], [{\n    key: \"getRelationships\",\n    value: function getRelationships() {\n      // handling family relationships\n      var relationships = {\n        \"grandmother\": {\n          \"partner\": \"grandfather\",\n          \"daughter\": \"aunt\",\n          \"son\": \"uncle\"\n        },\n        \"mother\": {\n          \"father\": \"grandfather\",\n          \"mother\": \"grandmother\",\n          \"partner\": \"father\",\n          \"daughter\": \"sister\",\n          \"son\": \"brother\"\n        },\n        \"motherinlaw\": {\n          \"partner\": \"fatherinlaw\",\n          \"daughter\": \"sisterinlaw\",\n          \"son\": \"brotherinlaw\"\n        },\n        \"aunt\": {\n          \"partner\": \"uncleinlaw\",\n          \"daughter\": \"cousinf\",\n          \"son\": \"cousinm\"\n        },\n        \"auntinlaw\": {\n          \"partner\": \"uncle\",\n          \"daughter\": \"cousinf\",\n          \"son\": \"cousinm\"\n        },\n        \"you\": {\n          \"father\": \"father\",\n          \"mother\": \"mother\",\n          \"partner\": \"partner\",\n          \"daughter\": \"daughter\",\n          \"son\": \"son\"\n        },\n        \"partner\": {\n          \"father\": \"fatherinlaw\",\n          \"mother\": \"motherinlaw\",\n          \"partner\": \"you\",\n          \"daughter\": \"daughter\",\n          \"son\": \"son\"\n        },\n        \"sister\": {\n          \"father\": \"father\",\n          \"mother\": \"mother\",\n          \"partner\": \"brotherinlaw\",\n          \"daughter\": \"niece\",\n          \"son\": \"nephew\"\n        },\n        \"sisterinlaw\": {\n          \"daughter\": \"niece\",\n          \"son\": \"nephew\"\n        },\n        \"daughter\": {\n          \"father\": \"partner\",\n          \"mother\": \"partner\",\n          \"partner\": \"soninlaw\",\n          \"daughter\": \"granddaughter\",\n          \"son\": \"grandson\"\n        },\n        \"daughterinlaw\": {\n          \"partner\": \"son\",\n          \"daughter\": \"granddaughter\",\n          \"son\": \"grandson\"\n        },\n        \"granddaughter\": {\n          \"father\": \"soninlaw\",\n          \"mother\": \"daughterinlaw\"\n        }\n        //translating for males\n      };var relationshipsEquiv = [[\"grandfather\", \"grandmother\", \"grandmother\"], [\"father\", \"mother\", \"mother\"], [\"fatherinlaw\", \"motherinlaw\", \"motherinlaw\"], [\"uncle\", \"aunt\", \"auntinlaw\"], [\"uncleinlaw\", \"auntinlaw\", \"aunt\"], [\"brother\", \"sister\", \"sisterinlaw\"], [\"brotherinlaw\", \"sisterinlaw\", \"woman\"], [\"son\", \"daughter\", \"daughterinlaw\"], [\"soninlaw\", \"daughterinlaw\", \"daughter\"], [\"grandson\", \"granddaughter\", \"woman\"]];\n      relationshipsEquiv.forEach(function (tuple) {\n        relationships[tuple[0]] = JSON.parse(JSON.stringify(relationships[tuple[1]]));\n        relationships[tuple[0]][\"partner\"] = tuple[2];\n      });\n      return relationships;\n    }\n  }, {\n    key: \"getEmptyFamilyTree\",\n    value: function getEmptyFamilyTree() {\n      var emptyFamilyTree = {\n        \"class\": \"FamilyTreeLayout\",\n        \"nodes\": [{\n          \"id\": \"@I1@\",\n          \"sex\": \"F\",\n          \"tag\": \"INDI\",\n          \"fams\": [],\n          \"famc\": null,\n          \"chil\": [],\n          \"wife\": null,\n          \"husb\": null,\n          \"sequencedDNA\": false,\n          \"i18nName\": \"you\"\n        }],\n        \"properties\": [\"id\", \"name\", \"sex\", \"tag\", \"fams\", \"famc\", \"chil\", \"wife\", \"husb\", \"sequencedDNA\", \"lastSequencedDNA\", \"i18nName\"],\n        \"centerNodeId\": 0\n      };\n      return _FamilyTreeLayout.FamilyTreeLayout.unserialize(JSON.stringify(emptyFamilyTree));\n    }\n\n    /** getSex() returns \"F\" if given relation is female, \"M\" if male */\n\n  }, {\n    key: \"getSex\",\n    value: function getSex(relation) {\n      var partnerRelation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var males = [\"man\", \"grandfather\", \"father\", \"fatherinlaw\", \"uncle\", \"uncleinlaw\", \"brother\", \"brotherinlaw\", \"cousinm\", \"son\", \"soninlaw\", \"nephew\", \"grandson\"];\n      var females = [\"woman\", \"grandmother\", \"mother\", \"motherinlaw\", \"aunt\", \"auntinlaw\", \"sister\", \"sisterinlaw\", \"cousinf\", \"daughter\", \"daughterinlaw\", \"niece\", \"granddaughter\"];\n      if (males.findIndex(function (r) {\n        return r == relation;\n      }) != -1) {\n        return \"M\";\n      }\n      if (females.findIndex(function (r) {\n        return r == relation;\n      }) != -1) {\n        return \"F\";\n      }\n      if (males.findIndex(function (r) {\n        return r == partnerRelation;\n      }) != -1) {\n        return \"F\";\n      }\n      if (females.findIndex(function (r) {\n        return r == partnerRelation;\n      }) != -1) {\n        return \"M\";\n      }\n\n      return undefined;\n    }\n  }]);\n\n  return KinGenomicPrivacyMeter;\n}();\n\n//# sourceURL=webpack:///./app/src/js/KinGenomicPrivacyMeter.js?");

/***/ }),

/***/ "./app/src/js/NodeButtonsGroup.js":
/*!****************************************!*\
  !*** ./app/src/js/NodeButtonsGroup.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar standardNodeButtons = exports.standardNodeButtons = [\"add-relative\", \"remove-node\", \"toggle-dna\", \"set-as-target\"];\nvar targetNodeButtons = exports.targetNodeButtons = [\"add-relative\"];\nvar youNodeButtons = exports.youNodeButtons = [\"add-relative\", \"change-sex\", \"toggle-dna\", \"set-as-target\"];\nvar youTargetNodeButtons = exports.youTargetNodeButtons = [\"add-relative\", \"change-sex\"];\n\n/**\n * Singleton class to handle buttons for a given node\n *\n */\n\nvar NodeButtonsGroup = exports.NodeButtonsGroup = function () {\n  /**\n   *\n   * @param {d3-selection} motherGroup a d3-selection containing the <g> group where the tree will be drawn (=familyTreeArtist.svgg)\n   * @param {string} DOMid an id for the node buttons'<g> mother tag\n   */\n  function NodeButtonsGroup(motherGroup, indiNodeSizeWidth) {\n    var DOMid = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"nodeg-action-buttons\";\n\n    _classCallCheck(this, NodeButtonsGroup);\n\n    this.DOMid = DOMid;\n    this.currentNode = undefined;\n    this.buttons = {};\n    this.onWakeCallbacks = [];\n    this.onHideCallbacks = [];\n\n    // ensure there is only 1 NodeButtonsGroup on svg\n    d3.select(\"#\" + this.DOMid).remove();\n    this.g = motherGroup.append(\"g\").attr(\"id\", this.DOMid);\n\n    // add a circle hitbox as trigger for nodeButtons mouseleave\n    this.g.append(\"circle\").attr(\"r\", indiNodeSizeWidth / 2 + 10) //kgp.indiNodeSize.width/2+10)\n    .attr(\"fill\", \"none\").attr(\"stroke-width\", \"20px\").attr(\"stroke\", \"white\").attr(\"stroke-opacity\", 0);\n  }\n\n  /**\n   * Wake the node buttons for a given node\n   *\n   * @param {Object} node a node of the family tree with a \"buttons\" property.\n   */\n\n\n  _createClass(NodeButtonsGroup, [{\n    key: \"wake\",\n    value: function wake(node) {\n      this.hide();\n      this.currentNode = node;\n      this.g.attr(\"transform\", \"translate(\" + node.x + \",\" + node.y + \")\").attr(\"visibility\", \"visible\").datum(node);\n      this.g.node().parentNode.appendChild(this.g.node());\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = node.buttons[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var btn = _step.value;\n\n          this.buttons[btn].attr(\"visibility\", \"visible\").datum(node);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      this.onWakeCallbacks.forEach(function (cb) {\n        return cb(node);\n      });\n    }\n\n    /**\n     * Hide the node buttons\n     */\n\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.g.attr(\"visibility\", \"hidden\");\n      for (var btn in this.buttons) {\n        this.buttons[btn].attr(\"visibility\", \"hidden\");\n      }\n      var node = this.currentNode;\n      this.onHideCallbacks.forEach(function (cb) {\n        return cb(node);\n      });\n    }\n\n    /**\n     * Creates the button svg, including circle, Font-Awesome logo and tooltip\n     *\n     * @param {string} buttonName the unique reference name for that button\n     * @param {int} x the button x position, relative to node center\n     * @param {int} y the button y position, relative to node center\n     * @param {string} FAunicode the button's Font-Awesome logo unicode code\n     * @param {int} options.FAx FAunicode's x position, relative to button position, defaults to -13\n     * @param {int} options.FAy FAunicode's y position, relative to button position, defaults to 6\n     * @param {int} options.tooltipx tooltip's x position, relative to button position, defaults to 24\n     * @param {int} options.tooltipy tooltip's y position, relative to button position, defaults to -22\n     * @param {int} tooltipWidth tooltip svg <text> tag width\n     * @param {int} tooltipHeight  tooltip svg <text> tag height (most often 45)\n     * @param {string} i18nKey the i18n key of the text for the tooltip\n     */\n\n  }, {\n    key: \"addButton\",\n    value: function addButton(buttonName, x, y, FAunicode, tooltipWidth, tooltipHeight, i18n, i18nKey) {\n      var options = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : {};\n\n      var defaultSettings = {\n        FAx: -13, FAy: 6, tooltipx: 24, tooltipy: -22\n      };\n\n      var button = this.g.append(\"g\").attr(\"transform\", \"translate(\" + x + \",\" + y + \")\").attr(\"style\", \"cursor:pointer;\").classed(\"button-with-tooltip\", true);\n      button.append(\"circle\").attr(\"r\", 20).classed(\"node-button-circle\", true);\n      button.append(\"text\").attr(\"class\", \"fas node-button-fas\").attr(\"x\", options.FAx ? options.FAx : defaultSettings.FAx).attr(\"y\", options.FAy ? options.FAy : defaultSettings.FAy).text(FAunicode);\n      button.append(\"foreignObject\").attr(\"x\", options.tooltipx ? options.tooltipx : defaultSettings.tooltipx).attr(\"y\", options.tooltipy ? options.tooltipy : defaultSettings.tooltipy).attr(\"width\", tooltipWidth).attr(\"height\", tooltipHeight).classed(\"tooltip\", true).append(\"xhtml:div\").append(\"span\").classed(\"tooltip-text\", true).attr(i18n.keyAttr, i18nKey);\n\n      this.buttons[buttonName] = button;\n      return button;\n    }\n  }]);\n\n  return NodeButtonsGroup;\n}();\n\n//# sourceURL=webpack:///./app/src/js/NodeButtonsGroup.js?");

/***/ }),

/***/ "./app/src/js/TrashButton.js":
/*!***********************************!*\
  !*** ./app/src/js/TrashButton.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TrashButton = exports.TrashButton = function () {\n  function TrashButton(domId, kgp) {\n    var listeners = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    _classCallCheck(this, TrashButton);\n\n    this.domId = domId;\n    this.kgp = kgp;\n    this.listeners = listeners;\n    this.init();\n  }\n\n  _createClass(TrashButton, [{\n    key: \"init\",\n    value: function init() {\n      d3.select(\"#\" + this.domId).remove();\n      // trash button\n      this.trashButton = this.kgp.addSvgButton(\"\\uF2ED\", this.domId, \"hint-trash\", 1, 27);\n      var self = this;\n      Object.keys(this.listeners).forEach(function (k) {\n        return self.trashButton.on(k, self.listeners[k]);\n      });\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, listener) {\n      this.listeners[event] = listener;\n      this.trashButton.on(event, listener);\n    }\n  }]);\n\n  return TrashButton;\n}();\n\n// 9.12.2019: untested and unused\n\n\nvar TrashButtonWithConfirmation = function () {\n  /**\n   * Creates the trash button\n   */\n  function TrashButtonWithConfirmation(domId, kgp) {\n    var _this = this;\n\n    var confirmListeners = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n    _classCallCheck(this, TrashButtonWithConfirmation);\n\n    this.domId = domId;\n    this.kgp = kgp;\n    this.listeners = confirmListeners;\n    d3.select(\"#\" + domId).remove();\n    // trash button\n    var self = this;\n    var trashButton = this.kgp.addSvgButton(\"\\uF2ED\", domId, \"hint-trash\", 0);\n    trashButton.on(\"click.confirm\", function (d) {\n      trashButton.select(\".tooltip\").remove();\n      var confirmDiv = trashButton.append(\"foreignObject\").attr(\"x\", 0).attr(\"y\", 25).attr(\"width\", 250).attr(\"height\", 80).classed(\"tooltip\", true).append(\"xhtml:div\").classed(\"tooltip-text\", true).html(\"<span style='display:block;' \" + self.kgp.i18n.keyAttr + \"='trash-sure'></span>\");\n      // cancel button\n      confirmDiv.append(\"button\").classed(\"btn btn-large btn-primary\", true).attr(\"style\", \"float:center;margin:2px;\").html('<span ' + self.kgp.i18n.keyAttr + '=\"trash-cancel\"></span> <i class=\"fas fa-times\"></i>').on(\"click.cancel\", function (d) {\n        new TrashButtonWithConfirmation(self.domId, self.kgp, self.listeners);\n      });\n      // confirm button\n      _this.trashButton = confirmDiv.append(\"button\").classed(\"btn btn-large btn-danger\", true).attr(\"style\", \"float:center;margin:2px;\").html('<span ' + self.kgp.i18n.keyAttr + '=\"trash-confirm\"></span> <i class=\"far fa-trash-alt\"></i>').on(\"click.listeners\", function (d) {\n        self.listeners.forEach(function (f) {\n          return f(d);\n        });\n        new TrashButtonWithConfirmation(self.domId, self.kgp, self.listeners);\n      });\n      // weird: manual rfresh needed...\n      self.i18n.refresh();\n    });\n  }\n\n  _createClass(TrashButtonWithConfirmation, [{\n    key: \"on\",\n    value: function on(event, listener) {\n      this.trashButton.on(event, listener);\n    }\n  }]);\n\n  return TrashButtonWithConfirmation;\n}();\n\n//# sourceURL=webpack:///./app/src/js/TrashButton.js?");

/***/ }),

/***/ "./app/src/js/app.js":
/*!***************************!*\
  !*** ./app/src/js/app.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n// languageLoader and i18n object: Internationalisation\nvar languageLoader = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(lng) {\n    var translation;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(\"./i18n/\" + lng + \".json\");\n\n          case 2:\n            translation = _context.sent;\n\n            if (!(translation.status == 200)) {\n              _context.next = 10;\n              break;\n            }\n\n            _context.next = 6;\n            return translation.json();\n\n          case 6:\n            translation = _context.sent;\n            return _context.abrupt(\"return\", translation);\n\n          case 10:\n            throw {\n              message: 'loading of translation \"' + lng + '\" failed',\n              lng: lng,\n              response: translation\n            };\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function languageLoader(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar _KinGenomicPrivacyMeter = __webpack_require__(/*! ./KinGenomicPrivacyMeter.js */ \"./app/src/js/KinGenomicPrivacyMeter.js\");\n\nvar _KgpTutorial = __webpack_require__(/*! ./KgpTutorial.js */ \"./app/src/js/KgpTutorial.js\");\n\nvar _i18n = __webpack_require__(/*! ./lib/i18n.js */ \"./app/src/js/lib/i18n.js\");\n\nvar _cookies = __webpack_require__(/*! ./lib/cookies.js */ \"./app/src/js/lib/cookies.js\");\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\n/* NodeList polyfill for IE11: not included in Babel (->?!?) */\nif ('NodeList' in window && !NodeList.prototype.forEach) {\n  console.info('polyfill for IE11');\n  NodeList.prototype.forEach = function (callback, thisArg) {\n    thisArg = thisArg || window;\n    for (var i = 0; i < this.length; i++) {\n      callback.call(thisArg, this[i], i, this);\n    }\n  };\n}\n\nfunction onChangeLanguage(oldLng, newLng) {\n  _cookies.cookie.create(\"lng\", newLng, 30);\n  // ensure external links target is blank to open them in a new page. Timeout, otherwise doesn't work\n  setTimeout(function () {\n    d3.selectAll(\".ext-link\").attr(\"target\", \"blank\");\n  }, 1);\n}\n\nvar i18n = new _i18n.Internationalisation([\"en\", \"fr\", \"de\", \"it\", \"es\"], languageLoader, _cookies.cookie.read(\"lng\"), true, \"kgpmeter.\");\ni18n.languageChangeCallbacks.push(onChangeLanguage);\ni18n.observe(document);\n//i18n.dynamic[\"cookie-text\"] = (t,d) => t.replace(\"{#1}\",Boolean(document.URL.match(/\\/privacy-dev\\//))? \"/privacy-dev\" : \"/privacy\")\n\n\n//constructor(api_base_url, svgId, youNodeId, i18n, maxFamilyTreeDepth=5, cookieLocalStoragePrefix=\"kgpmeter-\"){\nvar kgp = void 0;\nfunction initKgp(options) {\n  kgp = new _KinGenomicPrivacyMeter.KinGenomicPrivacyMeter(\"../\", \"svg-kin-genomics-privacy-app\", \"@I1@\", i18n, options);\n}\nif (window.parent != window) {\n  /*window.document.addEventListener(\n    'KgpSetKgpOptionsEvent',\n    (e)=>{\n      initKgp(e.details.options)\n    }, false)*/\n  initKgp({});\n} else {\n  initKgp({});\n}\nwindow.kgp = kgp;\n\n//# sourceURL=webpack:///./app/src/js/app.js?");

/***/ }),

/***/ "./app/src/js/lib/cookies.js":
/*!***********************************!*\
  !*** ./app/src/js/lib/cookies.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar cookie = exports.cookie = {\n  create: function createCookie(name, value, days) {\n    var expires;\n\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toGMTString();\n    } else {\n      expires = \"\";\n    }\n    document.cookie = encodeURIComponent(name) + \"=\" + encodeURIComponent(value) + expires + \"; path=/\";\n  },\n\n  read: function readCookie(name) {\n    var nameEQ = encodeURIComponent(name) + \"=\";\n    var ca = document.cookie.split(';');\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length);\n      }if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));\n    }\n    return null;\n  },\n\n  erase: function eraseCookie(name) {\n    document.cookie = encodeURIComponent(name) + \"=;expires=\" + new Date().toGMTString() + \"; path=/\";\n  }\n};\n\n//# sourceURL=webpack:///./app/src/js/lib/cookies.js?");

/***/ }),

/***/ "./app/src/js/lib/i18n.js":
/*!********************************!*\
  !*** ./app/src/js/lib/i18n.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/**\n * Class handling Internationalisation\n *\n * The basics:\n * 1) It uses (flat) dictionaries key->translation for each language.\n * 2) Each tag containing text should have a tag attribute \"data-i18n\" containing the corresponding dictionary key.\n *    Internationalisation constantly watches for changes to \"data-i18n\" attributes, so they can be added or removed on-the-fly\n * It also handles dynamic content:\n * 3) dynamic data for each tag can be held as JSON in its \"data-i18n-data\" attribute, to add data, you can use i18n.data().\n *    The data in the \"data-i18n-data\" can be any valid JSON object.\n * 4) Texts are dynamically modified by adding a function to the corresponding \"data-i18n\" keys in\n *    Internationalisation \"dynamic\" dictionary. those function should be of the form function(str,JSONdata) -> str.\n *\n *\n * For example:\n * <div class=\"node-name\" spellcheck=\"false\" data-i18n=\"node-name-you\" maxlength=\"26\" rows=\"2\"></div>\n * Indicates that this div contains the text corresponding to \"node-name-you\"\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Internationalisation = function () {\n\n  /**\n   *\n   * @param {Array[string]} supportedLanguages an array of language string identifiers (e.g [\"en\", \"fr\",\"de\"])\n   * @param {function} languageLoader a (possibly async) function taking as argument a language string from\n   *         supportedLanguages and returning the translations.\n   * @param {string} lng a language string identifier, the chosen language to display the website.\n   * @param {dictionary[string,function]} dynamic a dictionary str->function to handle dynamic content.\n   * @param {string} keyAttr the name of the html5 attribute to watch for keys, by default \"data-i18n\"\n   * @param {string} dataAttr the name of the html5 attribute to watch for data, by default \"data-i18n-data\".\n   */\n  function Internationalisation(supportedLanguages, languageLoader) {\n    var lng = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var useLocalStorage = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n    var localStoragePrefix = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n    var dynamic = arguments[5];\n    var keyAttr = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : \"data-i18n\";\n    var dataAttr = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : \"data-i18n-data\";\n\n    _classCallCheck(this, Internationalisation);\n\n    this.dynamic = dynamic ? dynamic : {};\n    this.keyAttr = keyAttr;\n    this.dataAttr = dataAttr;\n    this.useLocalStorage = useLocalStorage;\n    this.localStoragePrefix = localStoragePrefix;\n    this.supportedLanguages = supportedLanguages;\n    this.defaultLanguage = this.supportedLanguages[0];\n    this.languageChangeCallbacks = [];\n    // take language from url (if lng param present): on all browsers but IE\n    if (!(navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > -1)) {\n      //not-IE detection\n      var params = new URL(document.location).searchParams;\n      if (supportedLanguages.includes(params.get(\"lng\"))) {\n        lng = params.get(\"lng\");\n      }\n    }\n    this.lng = lng;\n    // try to take it from navigator.language:\n    if (!this.lng) {\n      this.lng = this.supportedLanguages.find(function (ln) {\n        return navigator.language.match(ln);\n      });\n    }\n    // try to take it from navigator.languageS:\n    if (!this.lng && navigator.languages) {\n      this.lng = this.supportedLanguages.find(function (ln) {\n        return navigator.languages.includes(ln);\n      });\n    }\n    //otherwise, use default:\n    if (!this.lng) {\n      this.lng = this.defaultLanguage;\n    }\n    this.languageLoader = languageLoader;\n    this.translations = {};\n    // translationsPromises: ensure we await the translations are loaded before we t()/fill()/refresh()\n    this.translationsPromises = {};\n\n    // observerConfig: we follow changes to this.keyAttr (=\"data-i18n\") attribute\n    this._observerConfig = {\n      attributes: true,\n      attributeFilter: [this.keyAttr, this.dataAttr],\n      subtree: true\n\n      // function wrapper needed as \"this\" will actually refer to the MutationObserver\n    };var mutationCallback = function (obj) {\n      return function (mutations) {\n        mutations.forEach(function (m) {\n          return obj.fill(m.target);\n        });\n      };\n    }(this);\n\n    this._observer = new MutationObserver(mutationCallback);\n\n    this.changeLanguage(this.lng);\n  }\n\n  /** Get or sets the data for the given data-i18n key\n   *\n   * @param {str} key a data-i18n key\n   * @param {Object} data null to get the current data, or an object to set the data for the key\n   */\n\n\n  _createClass(Internationalisation, [{\n    key: \"data\",\n    value: function data(key) {\n      var _data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var elList = document.querySelectorAll(\"[\" + this.keyAttr + \"=\" + key + \"]\");\n      if (elList.length == 0) {\n        return null;\n      }\n      if (!_data) {\n        return elList[0];\n      }\n      _data = JSON.stringify(_data);\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = elList[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var el = _step.value;\n\n          el.setAttribute(this.dataAttr, _data);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n\n    /** Gives text in currently selected language, with optional string formatter\n     * @param {string} key a valid translation key\n     * @param {Object} data data for the formatter (or an array of replacements for {})\n     * @param {function(string, data): string} formatter an optional formatter, by default the corresponding function in this.dynamic\n     */\n\n  }, {\n    key: \"t\",\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(key) {\n        var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n        var formatter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.dynamic[key];\n        var lng = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : this.lng;\n\n        var text, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, d;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.translationsPromises[lng];\n\n              case 2:\n                //console.log(\"t(), key: \",key,\", data: \", data, \", formatter: \",formatter)\n                text = this.translations[lng][key];\n                //console.log(\"t(), text: \", text)\n\n                if (!formatter) {\n                  _context.next = 7;\n                  break;\n                }\n\n                text = formatter(text, data);\n                _context.next = 26;\n                break;\n\n              case 7:\n                _iteratorNormalCompletion2 = true;\n                _didIteratorError2 = false;\n                _iteratorError2 = undefined;\n                _context.prev = 10;\n\n                for (_iterator2 = data[Symbol.iterator](); !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                  d = _step2.value;\n\n                  text = text.replace(\"{}\", d);\n                }\n                _context.next = 18;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](10);\n                _didIteratorError2 = true;\n                _iteratorError2 = _context.t0;\n\n              case 18:\n                _context.prev = 18;\n                _context.prev = 19;\n\n                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                  _iterator2.return();\n                }\n\n              case 21:\n                _context.prev = 21;\n\n                if (!_didIteratorError2) {\n                  _context.next = 24;\n                  break;\n                }\n\n                throw _iteratorError2;\n\n              case 24:\n                return _context.finish(21);\n\n              case 25:\n                return _context.finish(18);\n\n              case 26:\n                return _context.abrupt(\"return\", text);\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[10, 14, 18, 26], [19,, 21, 25]]);\n      }));\n\n      function t(_x10) {\n        return _ref.apply(this, arguments);\n      }\n\n      return t;\n    }()\n\n    /** fills the given DOM node with its text in the current language.\n     */\n\n  }, {\n    key: \"fill\",\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(DOMnode) {\n        var key, data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!DOMnode.hasAttribute(this.keyAttr)) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                key = DOMnode.getAttribute(this.keyAttr);\n                // if tag also as i18n data fill the text with it\n\n                data = DOMnode.hasAttribute(this.dataAttr) ? JSON.parse(DOMnode.getAttribute(this.dataAttr)) : [];\n                //console.log(DOMnode, \"to be filled with key: '\"+key+\"' and data: \", data)\n\n                _context2.next = 5;\n                return this.t(key, data);\n\n              case 5:\n                DOMnode.innerHTML = _context2.sent;\n                return _context2.abrupt(\"return\", DOMnode.innerHTML);\n\n              case 9:\n                return _context2.abrupt(\"return\", -1);\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function fill(_x11) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return fill;\n    }()\n\n    /** Observe changes to the given DOM node for translations.\n     */\n\n  }, {\n    key: \"observe\",\n    value: function observe() {\n      var DOMnode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n\n      return this._observer.observe(DOMnode, this._observerConfig);\n    }\n\n    /** refreshes the translations of the given DOM node and its subtree.\n     */\n\n  }, {\n    key: \"refresh\",\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var _this = this;\n\n        var DOMnode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", Promise.all([].concat(_toConsumableArray(DOMnode.querySelectorAll(\"[\" + this.keyAttr + \"]\"))).map(function (n) {\n                  return _this.fill(n);\n                })));\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function refresh() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return refresh;\n    }()\n\n    /** Loads the asked language.\n     * @param {string} lng language string identifier\n     */\n\n  }, {\n    key: \"loadLanguage\",\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(lng) {\n        var translation;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                translation = this.useLocalStorage ? this.loadLngFromLocalStorage(lng) : false;\n\n                if (!translation) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                this.translations[lng] = translation;\n                _context4.next = 10;\n                break;\n\n              case 5:\n                this.translationsPromises[lng] = this.languageLoader(lng);\n                _context4.next = 8;\n                return this.translationsPromises[lng];\n\n              case 8:\n                this.translations[lng] = _context4.sent;\n\n                if (this.useLocalStorage) {\n                  this.saveLngToLocalStorage(lng, this.translations[lng]);\n                }\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function loadLanguage(_x14) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return loadLanguage;\n    }()\n\n    /** Change to given language, handles the loading of translations if needed\n     * @param {string} lng language string identifier\n     */\n\n  }, {\n    key: \"changeLanguage\",\n    value: function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(lng) {\n        var oldLng;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                oldLng = this.lng;\n\n                this.lng = lng;\n\n                if (this.translations[lng]) {\n                  _context5.next = 11;\n                  break;\n                }\n\n                _context5.prev = 3;\n                _context5.next = 6;\n                return this.loadLanguage(lng);\n\n              case 6:\n                _context5.next = 11;\n                break;\n\n              case 8:\n                _context5.prev = 8;\n                _context5.t0 = _context5[\"catch\"](3);\n\n                console.log('Unable to change language, loading of translations for \"' + lng + '\" failed. Error: ', _context5.t0);\n\n              case 11:\n                if (!this.translations[lng]) {\n                  _context5.next = 15;\n                  break;\n                }\n\n                _context5.next = 14;\n                return this.refresh();\n\n              case 14:\n                this.languageChangeCallbacks.forEach(function (cb) {\n                  return cb(oldLng, lng);\n                });\n\n              case 15:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[3, 8]]);\n      }));\n\n      function changeLanguage(_x15) {\n        return _ref5.apply(this, arguments);\n      }\n\n      return changeLanguage;\n    }()\n  }, {\n    key: \"loadLngFromLocalStorage\",\n    value: function loadLngFromLocalStorage(lng) {\n      var transKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"translation.\" + lng;\n      var saveDateKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"translation_save_date.\" + lng;\n\n\n      if (this.useLocalStorage) {\n        var transDict = localStorage.getItem(this.localStoragePrefix + transKey);\n        var transDictSaveDate = +localStorage.getItem(this.localStoragePrefix + saveDateKey);\n        if (Boolean(transDict) & transDictSaveDate + 2 * 3600 * 1000 >= +new Date()) {\n          return JSON.parse(transDict);\n        }\n      }\n      return null;\n    }\n  }, {\n    key: \"saveLngToLocalStorage\",\n    value: function saveLngToLocalStorage(lng, transDict) {\n      var transKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"translation.\" + lng;\n      var saveDateKey = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"translation_save_date.\" + lng;\n\n      if (this.useLocalStorage) {\n        localStorage.setItem(this.localStoragePrefix + transKey, JSON.stringify(transDict));\n        localStorage.setItem(this.localStoragePrefix + saveDateKey, +new Date());\n      }\n    }\n  }, {\n    key: \"resetLngLocalStorage\",\n    value: function resetLngLocalStorage() {\n      var transKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"translation.\";\n      var saveDateKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"translation_save_date.\";\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.supportedLanguages[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var lng = _step3.value;\n\n          localStorage.setItem(this.localStoragePrefix + transKey + lng, null);\n          localStorage.setItem(this.localStoragePrefix + saveDateKey + lng, null);\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n    }\n  }]);\n\n  return Internationalisation;\n}();\n\nexports.Internationalisation = Internationalisation;\n\n//# sourceURL=webpack:///./app/src/js/lib/i18n.js?");

/***/ }),

/***/ "./app/src/js/utils.js":
/*!*****************************!*\
  !*** ./app/src/js/utils.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.detectIE11 = detectIE11;\nexports.detectMobile = detectMobile;\nexports.onWindowResize = onWindowResize;\nfunction detectIE11() {\n  if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > -1) {\n    return true;\n  }\n  return false;\n}\n\nfunction detectMobile() {\n  if (navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i)) {\n    return true;\n  }\n  return false;\n}\n\n/** adds a 100ms without resize to window.onresize() before executing func (to avoid redraws every msec) */\nfunction onWindowResize(func) {\n  var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;\n\n  var doit = void 0;\n  window.onresize = function () {\n    clearTimeout(doit);\n    doit = setTimeout(func, timeout);\n  };\n}\n\n//# sourceURL=webpack:///./app/src/js/utils.js?");

/***/ })

/******/ });